<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Step2-GWASAndIndividualGenotypeDataQualityControls &mdash; Polygenic Risk Score Tools 1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=f2a433a1"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Polygenic Risk Score Tools Notebooks Workflow" href="NotebooksWorkflow.html" />
    <link rel="prev" title="Step1-DownloadSampleDataandSetupEnvironment" href="Step1-DownloadSampleDataandSetupEnvironment.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Polygenic Risk Score Tools
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Step1-DownloadSampleDataandSetupEnvironment.html">Step1-DownloadSampleDataandSetupEnvironment</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Step2-GWASAndIndividualGenotypeDataQualityControls</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#note-on-gwas-file">Note on GWAS File</a></li>
<li class="toctree-l2"><a class="reference internal" href="#genome-wide-association-study-gwas-base-data-quality-controls">Genome-Wide Association Study (GWAS) (Base Data) - Quality Controls</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#set-the-directory-where-the-files-are-located">Set the directory where the files are located</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#match-variants-between-gwas-and-individual-genotype-data">Match Variants Between GWAS and Individual Genotype Data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#steps-for-handling-rsids-in-gwas-and-genotype-data">Steps for Handling RSIDs in GWAS and Genotype Data</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#individual-genotype-data-target-data-processing">Individual genotype data (Target Data) Processing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#remove-people-with-missing-phenotype">Remove people with missing Phenotype</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#split-data-into-test-and-train-and-perform-quality-controls-on-training-data">Split Data into Test and Train and Perform Quality Controls on Training Data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pruning">Pruning</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cross-validation-designs">Cross-validation Designs</a></li>
<li class="toctree-l3"><a class="reference internal" href="#a-simple-analysis">A Simple Analysis</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#check-final-files">Check final files.</a></li>
<li class="toctree-l2"><a class="reference internal" href="#important-note">Important Note</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="NotebooksWorkflow.html">Polygenic Risk Score Tools Notebooks Workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="Plink.html">Plink</a></li>
<li class="toctree-l1"><a class="reference internal" href="PRSice-2.html">PRSice-2</a></li>
<li class="toctree-l1"><a class="reference internal" href="DBSLMM.html">DBSLMM</a></li>
<li class="toctree-l1"><a class="reference internal" href="GCTA.html">GCTA</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lassosum.html">Lassosum</a></li>
<li class="toctree-l1"><a class="reference internal" href="LDpred-2-Inf.html">LDpred-2-Inf</a></li>
<li class="toctree-l1"><a class="reference internal" href="LDpred-2-Grid.html">LDpred-2-Grid</a></li>
<li class="toctree-l1"><a class="reference internal" href="LDpred-2-Auto.html">LDpred-2-Auto</a></li>
<li class="toctree-l1"><a class="reference internal" href="LDpred-2-Lassosum.html">LDpred-2-Lassosum</a></li>
<li class="toctree-l1"><a class="reference internal" href="LDpred-funct-code.html">LDpred-funct</a></li>
<li class="toctree-l1"><a class="reference internal" href="GCTB-SBayesR.html">GCTB: Calculating PRS with SBayesR</a></li>
<li class="toctree-l1"><a class="reference internal" href="GCTB-SBayesRC.html">GCTB-SBayesRC</a></li>
<li class="toctree-l1"><a class="reference internal" href="LDAK-GenotypeData.html">LDAK-GenotypeData</a></li>
<li class="toctree-l1"><a class="reference internal" href="LDAK-GWAS.html">LDAK-GWAS</a></li>
<li class="toctree-l1"><a class="reference internal" href="PRScs.html">PRScs</a></li>
<li class="toctree-l1"><a class="reference internal" href="PRScsx.html">PRScsx</a></li>
<li class="toctree-l1"><a class="reference internal" href="tlpSum.html">tlpSum</a></li>
<li class="toctree-l1"><a class="reference internal" href="PRSbils.html">PRSbils</a></li>
<li class="toctree-l1"><a class="reference internal" href="CTPR.html">CTPR</a></li>
<li class="toctree-l1"><a class="reference internal" href="NPS.html">NPS</a></li>
<li class="toctree-l1"><a class="reference internal" href="SDPR.html">SDPR</a></li>
<li class="toctree-l1"><a class="reference internal" href="PANPRS.html">PANPRS</a></li>
<li class="toctree-l1"><a class="reference internal" href="BOLT-LMM.html">BOLT-LMM</a></li>
<li class="toctree-l1"><a class="reference internal" href="RapidoPGS-single.html">RapidoPGS-single</a></li>
<li class="toctree-l1"><a class="reference internal" href="LDpred-gibbs.html">LDpred-gibbs</a></li>
<li class="toctree-l1"><a class="reference internal" href="LDpred-fast.html">LDpred-fast</a></li>
<li class="toctree-l1"><a class="reference internal" href="LDpred-p%2Bt.html">LDpred-p+t</a></li>
<li class="toctree-l1"><a class="reference internal" href="LDpred-inf.html">LDpred-inf</a></li>
<li class="toctree-l1"><a class="reference internal" href="AnnoPredCode.html">AnnoPred</a></li>
<li class="toctree-l1"><a class="reference internal" href="PleioPredCode.html">PleioPred</a></li>
<li class="toctree-l1"><a class="reference internal" href="smtpredwMtOLS.html">smtpredwMtOLS</a></li>
<li class="toctree-l1"><a class="reference internal" href="smtpredwMtSBLUP.html">smtpredwMtSBLUP</a></li>
<li class="toctree-l1"><a class="reference internal" href="C%2BT.html">C+T</a></li>
<li class="toctree-l1"><a class="reference internal" href="viprs-simple.html">VIPRS-simple</a></li>
<li class="toctree-l1"><a class="reference internal" href="viprs-grid.html">VIPRS-grid</a></li>
<li class="toctree-l1"><a class="reference internal" href="HAIL.html">HAIL</a></li>
<li class="toctree-l1"><a class="reference internal" href="GEMMA-LM.html">GEMMA-LM</a></li>
<li class="toctree-l1"><a class="reference internal" href="GEMMA-LMM.html">GEMMA-LMM</a></li>
<li class="toctree-l1"><a class="reference internal" href="GEMMA-BSLMM.html">GEMMA-BSLMM</a></li>
<li class="toctree-l1"><a class="reference internal" href="MTG2.html">MTG2</a></li>
<li class="toctree-l1"><a class="reference internal" href="SCT.html">SCT</a></li>
<li class="toctree-l1"><a class="reference internal" href="XPBLUP.html">XPBLUP</a></li>
<li class="toctree-l1"><a class="reference internal" href="CTSLEB.html">CTSLEB</a></li>
<li class="toctree-l1"><a class="reference internal" href="PolyPred.html">PolyPred</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Polygenic Risk Score Tools</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Step2-GWASAndIndividualGenotypeDataQualityControls</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/Step2-GWASAndIndividualGenotypeDataQualityControls.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="step2-gwasandindividualgenotypedataqualitycontrols">
<h1>Step2-GWASAndIndividualGenotypeDataQualityControls<a class="headerlink" href="#step2-gwasandindividualgenotypedataqualitycontrols" title="Link to this heading"></a></h1>
<section id="note-on-gwas-file">
<h2>Note on GWAS File<a class="headerlink" href="#note-on-gwas-file" title="Link to this heading"></a></h2>
<ol class="arabic simple">
<li><p>It is important to note that different polygenic risk tools accept
Genome-Wide Association summary statistic files in various formats.</p></li>
<li><p>The information we have encompasses all the columns required by PRS
tools (where some fields are missing, we will highlight it).</p></li>
<li><p>For each individual tool, we will process this GWAS file so that it
can be consumed by a specific PRS tool for prediction. The specific
number of fields and the names of those fields are highlighted in
each tool’s documentation.</p></li>
</ol>
<p><strong>Fields in the GWAS File:</strong></p>
<p>These fields are also explained in <a class="reference external" href="https://choishingwan.github.io/PRS-Tutorial/base/">this
link</a>.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>C
H
R</p></th>
<th class="head"><p>B
P</p></th>
<th class="head"><p>SNP</p></th>
<th class="head"><p>A
1</p></th>
<th class="head"><p>A
2</p></th>
<th class="head"><p>N</p></th>
<th class="head"><p>SE</p></th>
<th class="head"><p>P</p></th>
<th class="head"><p>OR</p></th>
<th class="head"><p>INFO</p></th>
<th class="head"><p>MAF</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>7
5
6
6
0
4</p></td>
<td><p>r
s313
1962</p></td>
<td><p>A</p></td>
<td><p>G</p></td>
<td><p>3
8
8
0
2
8</p></td>
<td><p>0
.00
301
666</p></td>
<td><p>0.
483
171</p></td>
<td><p>0
.9978869
15712657</p></td>
<td><p>0.8
9055794
1364774</p></td>
<td><p>0
.3693895
92764921</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>7
6
8
4
4
8</p></td>
<td><p>rs
1256
2034</p></td>
<td><p>A</p></td>
<td><p>G</p></td>
<td><p>3
8
8
0
2
8</p></td>
<td><p>0
.00
329
472</p></td>
<td><p>0.
834
808</p></td>
<td><p>1.000687
31609353</p></td>
<td><p>0.8
9589351
1351165</p></td>
<td><p>0
.3368457
54096289</p></td>
</tr>
<tr class="row-even"><td><p>1</p></td>
<td><p>7
7
9
3
2
2</p></td>
<td><p>r
s404
0617</p></td>
<td><p>G</p></td>
<td><p>A</p></td>
<td><p>3
8
8
0
2
8</p></td>
<td><p>0
.00
303
344</p></td>
<td><p>0
.42
897</p></td>
<td><p>0
.9976035
56067569</p></td>
<td><p>0.8
9750829
0615237</p></td>
<td><p>0
.3773680
10940814</p></td>
</tr>
</tbody>
</table>
</section>
<section id="genome-wide-association-study-gwas-base-data-quality-controls">
<h2>Genome-Wide Association Study (GWAS) (Base Data) - Quality Controls<a class="headerlink" href="#genome-wide-association-study-gwas-base-data-quality-controls" title="Link to this heading"></a></h2>
<p>Please note that some tools have built-in quality control procedures for
both GWAS and genotype data.</p>
<section id="set-the-directory-where-the-files-are-located">
<h3>Set the directory where the files are located<a class="headerlink" href="#set-the-directory-where-the-files-are-located" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">filedirec</span> <span class="o">=</span> <span class="s2">&quot;SampleData1&quot;</span>
</pre></div>
</div>
<p>In case you are running the jobs on HPC and want to use parallel
computing, you can replace it with <code class="docutils literal notranslate"><span class="pre">sys.argv[1]</span></code>. All the files for a
specific phenotype will be produced in that specific directory, which in
this case is <code class="docutils literal notranslate"><span class="pre">SampleData1</span></code>.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">subprocess</span>

<span class="c1"># Set the directory where the files are located</span>
<span class="n">filedirec</span> <span class="o">=</span> <span class="s2">&quot;SampleData1&quot;</span>
<span class="c1">#filedirec = &quot;asthma_19&quot;</span>
<span class="c1">#filedirec = &quot;migraine_0&quot;</span>

<span class="c1"># Define file paths for different data files</span>
<span class="n">BED</span> <span class="o">=</span> <span class="n">filedirec</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="n">filedirec</span>
<span class="n">BIM</span> <span class="o">=</span> <span class="n">filedirec</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="n">filedirec</span><span class="o">+</span><span class="s2">&quot;.bim&quot;</span>
<span class="n">FAM</span> <span class="o">=</span> <span class="n">filedirec</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="n">filedirec</span><span class="o">+</span><span class="s2">&quot;.fam&quot;</span>
<span class="n">COV</span> <span class="o">=</span> <span class="n">filedirec</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="n">filedirec</span><span class="o">+</span><span class="s2">&quot;.cov&quot;</span>
<span class="n">Height</span> <span class="o">=</span> <span class="n">filedirec</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="n">filedirec</span><span class="o">+</span><span class="s2">&quot;.height&quot;</span>
<span class="n">GWAS</span> <span class="o">=</span> <span class="n">filedirec</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="n">filedirec</span><span class="o">+</span><span class="s2">&quot;.gz&quot;</span>

<span class="c1"># Read GWAS data from a compressed file using pandas</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">GWAS</span><span class="p">,</span> <span class="n">compression</span><span class="o">=</span><span class="s2">&quot;gzip&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;\s+&quot;</span><span class="p">)</span>

<span class="c1"># Display the initial number of rows in the dataframe</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Initial number of SNPs:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">))</span>

<span class="c1"># Apply quality control steps: Filter SNPs based on Minor Allele Frequency (MAF) and Imputation Information Score (INFO)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;MAF&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.01</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;INFO&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.8</span><span class="p">)]</span>

<span class="c1"># Display the number of rows after applying the filters</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of SNPs after quality control:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">))</span>


<span class="c1"># Display the number of rows after removing duplicate SNPs</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;SNPs in GWAS after removing duplicate SNPs:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">))</span>

<span class="c1"># Remove ambiguous SNPs with complementary alleles (C/G or A/T) to avoid potential errors</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="o">~</span><span class="p">((</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;A1&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;A&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;A2&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;T&#39;</span><span class="p">)</span> <span class="o">|</span>
          <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;A1&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;T&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;A2&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;A&#39;</span><span class="p">)</span> <span class="o">|</span>
          <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;A1&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;G&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;A2&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;C&#39;</span><span class="p">)</span> <span class="o">|</span>
          <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;A1&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;C&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;A2&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;G&#39;</span><span class="p">))]</span>

<span class="c1"># Display the final number of SNPs after removing ambiguous SNPs</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Final number of SNPs after removing ambiguous SNPs:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">))</span>

<span class="c1"># Save the data.</span>
<span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">GWAS</span><span class="p">,</span><span class="n">compression</span><span class="o">=</span><span class="s2">&quot;gzip&quot;</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">GWAS</span><span class="p">,</span><span class="n">compression</span><span class="o">=</span> <span class="s2">&quot;gzip&quot;</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s2">&quot;\s+&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Initial</span> <span class="n">number</span> <span class="n">of</span> <span class="n">SNPs</span><span class="p">:</span> <span class="mi">499617</span>
<span class="n">Number</span> <span class="n">of</span> <span class="n">SNPs</span> <span class="n">after</span> <span class="n">quality</span> <span class="n">control</span><span class="p">:</span> <span class="mi">499617</span>
<span class="n">SNPs</span> <span class="ow">in</span> <span class="n">GWAS</span> <span class="n">after</span> <span class="n">removing</span> <span class="n">duplicate</span> <span class="n">SNPs</span><span class="p">:</span> <span class="mi">499617</span>
<span class="n">Final</span> <span class="n">number</span> <span class="n">of</span> <span class="n">SNPs</span> <span class="n">after</span> <span class="n">removing</span> <span class="n">ambiguous</span> <span class="n">SNPs</span><span class="p">:</span> <span class="mi">499617</span>
<span class="mi">499617</span>
<span class="o">|</span>    <span class="o">|</span>   <span class="n">CHR</span> <span class="o">|</span>     <span class="n">BP</span> <span class="o">|</span> <span class="n">SNP</span>        <span class="o">|</span> <span class="n">A1</span>   <span class="o">|</span> <span class="n">A2</span>   <span class="o">|</span>      <span class="n">N</span> <span class="o">|</span>         <span class="n">SE</span> <span class="o">|</span>        <span class="n">P</span> <span class="o">|</span>       <span class="n">OR</span> <span class="o">|</span>     <span class="n">INFO</span> <span class="o">|</span>      <span class="n">MAF</span> <span class="o">|</span>
<span class="o">|---</span><span class="p">:</span><span class="o">|------</span><span class="p">:</span><span class="o">|-------</span><span class="p">:</span><span class="o">|</span><span class="p">:</span><span class="o">-----------|</span><span class="p">:</span><span class="o">-----|</span><span class="p">:</span><span class="o">-----|-------</span><span class="p">:</span><span class="o">|-----------</span><span class="p">:</span><span class="o">|---------</span><span class="p">:</span><span class="o">|---------</span><span class="p">:</span><span class="o">|---------</span><span class="p">:</span><span class="o">|---------</span><span class="p">:</span><span class="o">|</span>
<span class="o">|</span>  <span class="mi">0</span> <span class="o">|</span>     <span class="mi">1</span> <span class="o">|</span> <span class="mi">756604</span> <span class="o">|</span> <span class="n">rs3131962</span>  <span class="o">|</span> <span class="n">A</span>    <span class="o">|</span> <span class="n">G</span>    <span class="o">|</span> <span class="mi">388028</span> <span class="o">|</span> <span class="mf">0.00301666</span> <span class="o">|</span> <span class="mf">0.483171</span> <span class="o">|</span> <span class="mf">0.997887</span> <span class="o">|</span> <span class="mf">0.890558</span> <span class="o">|</span> <span class="mf">0.36939</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="mi">1</span> <span class="o">|</span>     <span class="mi">1</span> <span class="o">|</span> <span class="mi">768448</span> <span class="o">|</span> <span class="n">rs12562034</span> <span class="o">|</span> <span class="n">A</span>    <span class="o">|</span> <span class="n">G</span>    <span class="o">|</span> <span class="mi">388028</span> <span class="o">|</span> <span class="mf">0.00329472</span> <span class="o">|</span> <span class="mf">0.834808</span> <span class="o">|</span> <span class="mf">1.00069</span>  <span class="o">|</span> <span class="mf">0.895894</span> <span class="o">|</span> <span class="mf">0.336846</span> <span class="o">|</span>
<span class="o">|</span>  <span class="mi">2</span> <span class="o">|</span>     <span class="mi">1</span> <span class="o">|</span> <span class="mi">779322</span> <span class="o">|</span> <span class="n">rs4040617</span>  <span class="o">|</span> <span class="n">G</span>    <span class="o">|</span> <span class="n">A</span>    <span class="o">|</span> <span class="mi">388028</span> <span class="o">|</span> <span class="mf">0.00303344</span> <span class="o">|</span> <span class="mf">0.42897</span>  <span class="o">|</span> <span class="mf">0.997604</span> <span class="o">|</span> <span class="mf">0.897508</span> <span class="o">|</span> <span class="mf">0.377368</span> <span class="o">|</span>
<span class="o">|</span>  <span class="mi">3</span> <span class="o">|</span>     <span class="mi">1</span> <span class="o">|</span> <span class="mi">801536</span> <span class="o">|</span> <span class="n">rs79373928</span> <span class="o">|</span> <span class="n">G</span>    <span class="o">|</span> <span class="n">T</span>    <span class="o">|</span> <span class="mi">388028</span> <span class="o">|</span> <span class="mf">0.00841324</span> <span class="o">|</span> <span class="mf">0.808999</span> <span class="o">|</span> <span class="mf">1.00204</span>  <span class="o">|</span> <span class="mf">0.908963</span> <span class="o">|</span> <span class="mf">0.483212</span> <span class="o">|</span>
<span class="o">|</span>  <span class="mi">4</span> <span class="o">|</span>     <span class="mi">1</span> <span class="o">|</span> <span class="mi">808631</span> <span class="o">|</span> <span class="n">rs11240779</span> <span class="o">|</span> <span class="n">G</span>    <span class="o">|</span> <span class="n">A</span>    <span class="o">|</span> <span class="mi">388028</span> <span class="o">|</span> <span class="mf">0.00242821</span> <span class="o">|</span> <span class="mf">0.590265</span> <span class="o">|</span> <span class="mf">1.00131</span>  <span class="o">|</span> <span class="mf">0.893213</span> <span class="o">|</span> <span class="mf">0.45041</span>  <span class="o">|</span>
</pre></div>
</div>
</section>
</section>
<section id="match-variants-between-gwas-and-individual-genotype-data">
<h2>Match Variants Between GWAS and Individual Genotype Data<a class="headerlink" href="#match-variants-between-gwas-and-individual-genotype-data" title="Link to this heading"></a></h2>
<p>If RSID is present in the GWAS, the following step can be skipped.</p>
<section id="steps-for-handling-rsids-in-gwas-and-genotype-data">
<h3>Steps for Handling RSIDs in GWAS and Genotype Data<a class="headerlink" href="#steps-for-handling-rsids-in-gwas-and-genotype-data" title="Link to this heading"></a></h3>
<ol class="arabic simple">
<li><p>If RSIDs are not present for SNPs, put <code class="docutils literal notranslate"><span class="pre">X</span></code> in the SNP column in the
GWAS file.</p></li>
<li><p>Read the <code class="docutils literal notranslate"><span class="pre">genotype.bim</span></code> file and extract the RSIDs from the
genotype data.</p></li>
<li><p>If RSIDs are not present in the genotype data, use HapMap3 or another
reference panel to obtain the RSIDs.</p></li>
</ol>
<p>Some PRS tools use different criteria to create unique variants and
match them between GWAS and individual genotype data:</p>
<ul class="simple">
<li><p><strong>CHR:BP:A1:A2</strong>: Some PRS tools use this format to define a unique
variant.</p></li>
<li><p><strong>RSID</strong>: Some PRS tools use RSID/SNP to define a unique variant.</p></li>
<li><p><strong>CHR:BP</strong>: Some PRS tools use this format to define a unique
variant.</p></li>
</ul>
<p>We have highlighted which criteria are necessary for each tool.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bimfile</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">BIM</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;\s+&quot;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Columns of BIM file:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bimfile</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;First 10 rows of BIM file:&quot;</span><span class="p">)</span>


<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Removing SNPs for which even a single row does not contain the required value:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">))</span>


<span class="c1"># If RSID&#39;s are not present for SNPs, put X in the SNP column in the GWAS file.</span>
<span class="c1"># Read the genotype.bim file, and extract the RSID from the genotype data.</span>
<span class="c1"># If RSID are not present in the genotype data, use HapMap3 or other reference panel to get the RSIDs.</span>

<span class="k">if</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;SNP&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;X&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;RSIDs are missing!&quot;</span><span class="p">)</span>
    <span class="n">bimfile</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">filedirec</span><span class="o">+</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="o">+</span><span class="n">filedirec</span><span class="o">+</span><span class="s2">&quot;.bim&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;\s+&quot;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

    <span class="c1"># create a unique variant using CHR:BP:A1:A2.</span>

    <span class="n">bimfile</span><span class="p">[</span><span class="s2">&quot;match&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bimfile</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;_&quot;</span><span class="o">+</span><span class="n">bimfile</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;_&quot;</span><span class="o">+</span><span class="n">bimfile</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;_&quot;</span><span class="o">+</span><span class="n">bimfile</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;match&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;CHR&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;_&quot;</span><span class="o">+</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;BP&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;_&quot;</span><span class="o">+</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;A1&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;_&quot;</span><span class="o">+</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;A2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>




    <span class="n">df</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s1">&#39;match&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">bimfile</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s1">&#39;match&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;match&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">bimfile</span><span class="p">[</span><span class="s1">&#39;match&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)]</span>
    <span class="n">bimfile</span> <span class="o">=</span> <span class="n">bimfile</span><span class="p">[</span><span class="n">bimfile</span><span class="p">[</span><span class="s1">&#39;match&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;match&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)]</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;match&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">bimfile</span><span class="p">[</span><span class="s1">&#39;match&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)]</span>
    <span class="n">bimfile</span> <span class="o">=</span> <span class="n">bimfile</span><span class="p">[</span><span class="n">bimfile</span><span class="p">[</span><span class="s1">&#39;match&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;match&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)]</span>


    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;BP&#39;</span><span class="p">)</span>
    <span class="n">bimfile</span> <span class="o">=</span> <span class="n">bimfile</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">bimfile</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;SNP&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bimfile</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;match&quot;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">))</span>


    <span class="n">df</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s1">&#39;match&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">bimfile</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s1">&#39;match&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bimfile</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">bimfile</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

    <span class="k">del</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;match&quot;</span><span class="p">]</span>
    <span class="c1"># Just save the modified GWAS file.</span>
    <span class="c1"># If bim, file is modified, the genotype data will be considered as corupt by Plink.</span>
    <span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">GWAS</span><span class="p">,</span><span class="n">compression</span><span class="o">=</span><span class="s2">&quot;gzip&quot;</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Total SNPs&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">))</span>

    <span class="k">pass</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">df</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s1">&#39;SNP&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">GWAS</span><span class="p">,</span><span class="n">compression</span><span class="o">=</span><span class="s2">&quot;gzip&quot;</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;RSID is present!&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Total SNPs&quot;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">))</span>
    <span class="k">pass</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Columns of BIM file:
Index([0, 1, 2, 3, 4, 5], dtype=&#39;int64&#39;)
First 10 rows of BIM file:
Removing SNPs for which even a single row does not contain the required value: 499617
RSID is present!
Total SNPs 499617
</pre></div>
</div>
</section>
</section>
<section id="individual-genotype-data-target-data-processing">
<h2>Individual genotype data (Target Data) Processing<a class="headerlink" href="#individual-genotype-data-target-data-processing" title="Link to this heading"></a></h2>
<p>Ensure that the phenotype file, FAM file, and covariate file contain an
identical number of samples. Remove any missing samples based on your
data. Note that the extent of missingness in phenotypes and covariates
may vary.</p>
<p><strong>Note:</strong> Plink needs to be installed or placed in the same directory as
this notebook.</p>
<p><a class="reference external" href="https://www.cog-genomics.org/plink/">Download Plink</a></p>
<p>We recommend using Linux. In cases where Windows is required due to
package installation issues on Linux, we provide the following guidance:</p>
<ol class="arabic simple">
<li><p>For Windows, use <code class="docutils literal notranslate"><span class="pre">plink</span></code>.</p></li>
<li><p>For Linux, use <code class="docutils literal notranslate"><span class="pre">./plink</span></code>.</p></li>
</ol>
<section id="remove-people-with-missing-phenotype">
<h3>Remove people with missing Phenotype<a class="headerlink" href="#remove-people-with-missing-phenotype" title="Link to this heading"></a></h3>
<p>Modify the fam file, make bed file, and modify the covariates files as
well.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># New files to be saved with QC suffix</span>
<span class="n">newfilename</span> <span class="o">=</span> <span class="n">filedirec</span> <span class="o">+</span> <span class="s2">&quot;_QC&quot;</span>

<span class="c1"># Read information from FAM file</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">FAM</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;\s+&quot;</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;FID&quot;</span><span class="p">,</span> <span class="s2">&quot;IID&quot;</span><span class="p">,</span> <span class="s2">&quot;Father&quot;</span><span class="p">,</span> <span class="s2">&quot;Mother&quot;</span><span class="p">,</span> <span class="s2">&quot;Sex&quot;</span><span class="p">,</span> <span class="s2">&quot;Phenotype&quot;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;FAM file contents:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Total number of people in FAM file:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">f</span><span class="p">))</span>

<span class="c1"># Append the Height phenotype values to FAM file</span>
<span class="c1"># Height file is basically the phenotype file.</span>
<span class="n">h</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">Height</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Phenotype information is available for:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">h</span><span class="p">),</span> <span class="s2">&quot;people&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">h</span><span class="p">))</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;FID&#39;</span><span class="p">,</span> <span class="s1">&#39;IID&#39;</span><span class="p">])</span>

<span class="c1"># Replace &#39;Phenotype&#39; column with &#39;Height&#39; and save to a new PeopleWithPhenotype.txt file</span>
<span class="c1"># Ensure that the input Phenotype file has teh header Height.</span>
<span class="n">result</span><span class="p">[</span><span class="s2">&quot;Phenotype&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;Height&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="k">del</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;Height&quot;</span><span class="p">]</span>

<span class="c1"># Remove NA or missing in the phenotype column</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Phenotype&quot;</span><span class="p">])</span>


<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="n">result</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">filedirec</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="s2">&quot;PeopleWithPhenotype.txt&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Use plink to keep only the people with phenotype present</span>
<span class="n">plink_command</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;./plink&#39;</span><span class="p">,</span>
    <span class="s1">&#39;--bfile&#39;</span><span class="p">,</span> <span class="n">filedirec</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="n">filedirec</span><span class="p">,</span>
    <span class="s1">&#39;--keep&#39;</span><span class="p">,</span> <span class="n">filedirec</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="s2">&quot;PeopleWithPhenotype.txt&quot;</span><span class="p">,</span>
    <span class="s1">&#39;--make-bed&#39;</span><span class="p">,</span>
    <span class="s1">&#39;--out&#39;</span><span class="p">,</span> <span class="n">filedirec</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="n">newfilename</span>
<span class="p">]</span>
<span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">plink_command</span><span class="p">)</span>

<span class="c1"># Update the phenotype information in the new FAM file</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">filedirec</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="n">newfilename</span> <span class="o">+</span> <span class="s2">&quot;.fam&quot;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;\s+&quot;</span><span class="p">,</span>
                <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;FID&quot;</span><span class="p">,</span> <span class="s2">&quot;IID&quot;</span><span class="p">,</span> <span class="s2">&quot;Father&quot;</span><span class="p">,</span> <span class="s2">&quot;Mother&quot;</span><span class="p">,</span> <span class="s2">&quot;Sex&quot;</span><span class="p">,</span> <span class="s2">&quot;Phenotype&quot;</span><span class="p">])</span>
<span class="n">f</span><span class="p">[</span><span class="s2">&quot;Phenotype&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;Phenotype&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">f</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">filedirec</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="n">newfilename</span> <span class="o">+</span> <span class="s2">&quot;.fam&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Update the covariate file as well</span>
<span class="n">covfile</span> <span class="o">=</span> <span class="n">filedirec</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="n">filedirec</span> <span class="o">+</span> <span class="s1">&#39;.cov&#39;</span>
<span class="n">covfile</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">covfile</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;\s+&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Covariate file contents:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">covfile</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Total number of people in Covariate file:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">covfile</span><span class="p">))</span>

<span class="c1"># Match the FID and IID from covariate and height file</span>
<span class="n">covfile</span> <span class="o">=</span> <span class="n">covfile</span><span class="p">[</span><span class="n">covfile</span><span class="p">[</span><span class="s1">&#39;FID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="s2">&quot;FID&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">covfile</span><span class="p">[</span><span class="s1">&#39;IID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="s2">&quot;IID&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Covariate file contents after matching with FAM file:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">covfile</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Total number of people in Covariate file after matching:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">covfile</span><span class="p">))</span>
<span class="n">covfile</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">filedirec</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="n">newfilename</span> <span class="o">+</span> <span class="s2">&quot;.cov&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">FAM</span> <span class="n">file</span> <span class="n">contents</span><span class="p">:</span>
       <span class="n">FID</span>      <span class="n">IID</span>  <span class="n">Father</span>  <span class="n">Mother</span>  <span class="n">Sex</span>  <span class="n">Phenotype</span>
<span class="mi">0</span>  <span class="n">HG00096</span>  <span class="n">HG00096</span>       <span class="mi">0</span>       <span class="mi">0</span>    <span class="mi">1</span>         <span class="o">-</span><span class="mi">9</span>
<span class="mi">1</span>  <span class="n">HG00097</span>  <span class="n">HG00097</span>       <span class="mi">0</span>       <span class="mi">0</span>    <span class="mi">2</span>         <span class="o">-</span><span class="mi">9</span>
<span class="mi">2</span>  <span class="n">HG00099</span>  <span class="n">HG00099</span>       <span class="mi">0</span>       <span class="mi">0</span>    <span class="mi">2</span>         <span class="o">-</span><span class="mi">9</span>
<span class="mi">3</span>  <span class="n">HG00100</span>  <span class="n">HG00100</span>       <span class="mi">0</span>       <span class="mi">0</span>    <span class="mi">2</span>         <span class="o">-</span><span class="mi">9</span>
<span class="mi">4</span>  <span class="n">HG00101</span>  <span class="n">HG00101</span>       <span class="mi">0</span>       <span class="mi">0</span>    <span class="mi">1</span>         <span class="o">-</span><span class="mi">9</span>
<span class="n">Total</span> <span class="n">number</span> <span class="n">of</span> <span class="n">people</span> <span class="ow">in</span> <span class="n">FAM</span> <span class="n">file</span><span class="p">:</span> <span class="mi">503</span>
<span class="n">Phenotype</span> <span class="n">information</span> <span class="ow">is</span> <span class="n">available</span> <span class="k">for</span><span class="p">:</span> <span class="mi">475</span> <span class="n">people</span>
<span class="mi">475</span>
         <span class="n">FID</span>      <span class="n">IID</span>  <span class="n">Father</span>  <span class="n">Mother</span>  <span class="n">Sex</span>   <span class="n">Phenotype</span>
<span class="mi">0</span>    <span class="n">HG00096</span>  <span class="n">HG00096</span>       <span class="mi">0</span>       <span class="mi">0</span>    <span class="mi">1</span>  <span class="mf">169.132169</span>
<span class="mi">1</span>    <span class="n">HG00097</span>  <span class="n">HG00097</span>       <span class="mi">0</span>       <span class="mi">0</span>    <span class="mi">2</span>  <span class="mf">171.256259</span>
<span class="mi">2</span>    <span class="n">HG00099</span>  <span class="n">HG00099</span>       <span class="mi">0</span>       <span class="mi">0</span>    <span class="mi">2</span>  <span class="mf">171.534380</span>
<span class="mi">3</span>    <span class="n">HG00101</span>  <span class="n">HG00101</span>       <span class="mi">0</span>       <span class="mi">0</span>    <span class="mi">1</span>  <span class="mf">169.850176</span>
<span class="mi">4</span>    <span class="n">HG00102</span>  <span class="n">HG00102</span>       <span class="mi">0</span>       <span class="mi">0</span>    <span class="mi">2</span>  <span class="mf">172.788361</span>
<span class="o">..</span>       <span class="o">...</span>      <span class="o">...</span>     <span class="o">...</span>     <span class="o">...</span>  <span class="o">...</span>         <span class="o">...</span>
<span class="mi">470</span>  <span class="n">NA20822</span>  <span class="n">NA20822</span>       <span class="mi">0</span>       <span class="mi">0</span>    <span class="mi">2</span>  <span class="mf">170.405056</span>
<span class="mi">471</span>  <span class="n">NA20826</span>  <span class="n">NA20826</span>       <span class="mi">0</span>       <span class="mi">0</span>    <span class="mi">2</span>  <span class="mf">168.523029</span>
<span class="mi">472</span>  <span class="n">NA20827</span>  <span class="n">NA20827</span>       <span class="mi">0</span>       <span class="mi">0</span>    <span class="mi">1</span>  <span class="mf">170.975735</span>
<span class="mi">473</span>  <span class="n">NA20828</span>  <span class="n">NA20828</span>       <span class="mi">0</span>       <span class="mi">0</span>    <span class="mi">2</span>  <span class="mf">170.222028</span>
<span class="mi">474</span>  <span class="n">NA20832</span>  <span class="n">NA20832</span>       <span class="mi">0</span>       <span class="mi">0</span>    <span class="mi">2</span>  <span class="mf">169.431705</span>

<span class="p">[</span><span class="mi">475</span> <span class="n">rows</span> <span class="n">x</span> <span class="mi">6</span> <span class="n">columns</span><span class="p">]</span>
<span class="n">PLINK</span> <span class="n">v1</span><span class="mf">.90</span><span class="n">b7</span><span class="mf">.2</span> <span class="mi">64</span><span class="o">-</span><span class="n">bit</span> <span class="p">(</span><span class="mi">11</span> <span class="n">Dec</span> <span class="mi">2023</span><span class="p">)</span>           <span class="n">www</span><span class="o">.</span><span class="n">cog</span><span class="o">-</span><span class="n">genomics</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">plink</span><span class="o">/</span><span class="mf">1.9</span><span class="o">/</span>
<span class="p">(</span><span class="n">C</span><span class="p">)</span> <span class="mi">2005</span><span class="o">-</span><span class="mi">2023</span> <span class="n">Shaun</span> <span class="n">Purcell</span><span class="p">,</span> <span class="n">Christopher</span> <span class="n">Chang</span>   <span class="n">GNU</span> <span class="n">General</span> <span class="n">Public</span> <span class="n">License</span> <span class="n">v3</span>
<span class="n">Logging</span> <span class="n">to</span> <span class="n">SampleData1</span><span class="o">/</span><span class="n">SampleData1_QC</span><span class="o">.</span><span class="n">log</span><span class="o">.</span>
<span class="n">Options</span> <span class="ow">in</span> <span class="n">effect</span><span class="p">:</span>
  <span class="o">--</span><span class="n">bfile</span> <span class="n">SampleData1</span><span class="o">/</span><span class="n">SampleData1</span>
  <span class="o">--</span><span class="n">keep</span> <span class="n">SampleData1</span><span class="o">/</span><span class="n">PeopleWithPhenotype</span><span class="o">.</span><span class="n">txt</span>
  <span class="o">--</span><span class="n">make</span><span class="o">-</span><span class="n">bed</span>
  <span class="o">--</span><span class="n">out</span> <span class="n">SampleData1</span><span class="o">/</span><span class="n">SampleData1_QC</span>

<span class="mi">63761</span> <span class="n">MB</span> <span class="n">RAM</span> <span class="n">detected</span><span class="p">;</span> <span class="n">reserving</span> <span class="mi">31880</span> <span class="n">MB</span> <span class="k">for</span> <span class="n">main</span> <span class="n">workspace</span><span class="o">.</span>
<span class="mi">551892</span> <span class="n">variants</span> <span class="n">loaded</span> <span class="kn">from</span> <span class="nn">.bim</span> <span class="n">file</span><span class="o">.</span>
<span class="mi">503</span> <span class="n">people</span> <span class="p">(</span><span class="mi">240</span> <span class="n">males</span><span class="p">,</span> <span class="mi">263</span> <span class="n">females</span><span class="p">)</span> <span class="n">loaded</span> <span class="kn">from</span> <span class="nn">.fam.</span>
<span class="o">--</span><span class="n">keep</span><span class="p">:</span> <span class="mi">475</span> <span class="n">people</span> <span class="n">remaining</span><span class="o">.</span>
<span class="n">Using</span> <span class="mi">1</span> <span class="n">thread</span> <span class="p">(</span><span class="n">no</span> <span class="n">multithreaded</span> <span class="n">calculations</span> <span class="n">invoked</span><span class="p">)</span><span class="o">.</span>
<span class="n">Before</span> <span class="n">main</span> <span class="n">variant</span> <span class="n">filters</span><span class="p">,</span> <span class="mi">475</span> <span class="n">founders</span> <span class="ow">and</span> <span class="mi">0</span> <span class="n">nonfounders</span> <span class="n">present</span><span class="o">.</span>
<span class="n">Calculating</span> <span class="n">allele</span> <span class="n">frequencies</span><span class="o">...</span> <span class="mi">10111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394959697989</span> <span class="n">done</span><span class="o">.</span>
<span class="n">Total</span> <span class="n">genotyping</span> <span class="n">rate</span> <span class="ow">in</span> <span class="n">remaining</span> <span class="n">samples</span> <span class="ow">is</span> <span class="mf">0.999896</span><span class="o">.</span>
<span class="mi">551892</span> <span class="n">variants</span> <span class="ow">and</span> <span class="mi">475</span> <span class="n">people</span> <span class="k">pass</span> <span class="n">filters</span> <span class="ow">and</span> <span class="n">QC</span><span class="o">.</span>
<span class="n">Note</span><span class="p">:</span> <span class="n">No</span> <span class="n">phenotypes</span> <span class="n">present</span><span class="o">.</span>
<span class="o">--</span><span class="n">make</span><span class="o">-</span><span class="n">bed</span> <span class="n">to</span> <span class="n">SampleData1</span><span class="o">/</span><span class="n">SampleData1_QC</span><span class="o">.</span><span class="n">bed</span> <span class="o">+</span> <span class="n">SampleData1</span><span class="o">/</span><span class="n">SampleData1_QC</span><span class="o">.</span><span class="n">bim</span> <span class="o">+</span>
<span class="n">SampleData1</span><span class="o">/</span><span class="n">SampleData1_QC</span><span class="o">.</span><span class="n">fam</span> <span class="o">...</span> <span class="mi">101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899</span><span class="n">done</span><span class="o">.</span>
<span class="n">Covariate</span> <span class="n">file</span> <span class="n">contents</span><span class="p">:</span>
       <span class="n">FID</span>      <span class="n">IID</span>  <span class="n">Sex</span>
<span class="mi">0</span>  <span class="n">HG00096</span>  <span class="n">HG00096</span>    <span class="mi">1</span>
<span class="mi">1</span>  <span class="n">HG00097</span>  <span class="n">HG00097</span>    <span class="mi">2</span>
<span class="mi">2</span>  <span class="n">HG00099</span>  <span class="n">HG00099</span>    <span class="mi">2</span>
<span class="mi">3</span>  <span class="n">HG00100</span>  <span class="n">HG00100</span>    <span class="mi">2</span>
<span class="mi">4</span>  <span class="n">HG00101</span>  <span class="n">HG00101</span>    <span class="mi">1</span>
<span class="n">Total</span> <span class="n">number</span> <span class="n">of</span> <span class="n">people</span> <span class="ow">in</span> <span class="n">Covariate</span> <span class="n">file</span><span class="p">:</span> <span class="mi">503</span>
<span class="n">Covariate</span> <span class="n">file</span> <span class="n">contents</span> <span class="n">after</span> <span class="n">matching</span> <span class="k">with</span> <span class="n">FAM</span> <span class="n">file</span><span class="p">:</span>
       <span class="n">FID</span>      <span class="n">IID</span>  <span class="n">Sex</span>
<span class="mi">0</span>  <span class="n">HG00096</span>  <span class="n">HG00096</span>    <span class="mi">1</span>
<span class="mi">1</span>  <span class="n">HG00097</span>  <span class="n">HG00097</span>    <span class="mi">2</span>
<span class="mi">2</span>  <span class="n">HG00099</span>  <span class="n">HG00099</span>    <span class="mi">2</span>
<span class="mi">4</span>  <span class="n">HG00101</span>  <span class="n">HG00101</span>    <span class="mi">1</span>
<span class="mi">5</span>  <span class="n">HG00102</span>  <span class="n">HG00102</span>    <span class="mi">2</span>
<span class="n">Total</span> <span class="n">number</span> <span class="n">of</span> <span class="n">people</span> <span class="ow">in</span> <span class="n">Covariate</span> <span class="n">file</span> <span class="n">after</span> <span class="n">matching</span><span class="p">:</span> <span class="mi">475</span>
</pre></div>
</div>
</section>
</section>
<section id="split-data-into-test-and-train-and-perform-quality-controls-on-training-data">
<h2>Split Data into Test and Train and Perform Quality Controls on Training Data<a class="headerlink" href="#split-data-into-test-and-train-and-perform-quality-controls-on-training-data" title="Link to this heading"></a></h2>
<ol class="arabic simple">
<li><p>We adopt a cross-validation design to evaluate polygenic risk scores.</p></li>
<li><p>The base data is divided into two sets: training and test sets. The
training set is used to find the best combination of parameters or
hyperparameters offered by each tool, along with the summary
statistic file. The data is split into 5 folds, and further
processing is performed on the first fold. <code class="docutils literal notranslate"><span class="pre">Fold_0</span></code></p></li>
<li><p>Data is divided into training and test sets, and hyperparameter
optimization is performed on the training data. Operations such as
clumping or pruning are applied to the training data, and the same
remaining SNPs should be extracted from the test set rather than
separately using pruning or clumping on test data.</p></li>
<li><p>Regarding hyperparameters from individual tools, all of those should
be applied to the training set, and the performance should be
measured for both the null model and the complete model (including
covariates and polygenic risk scores). Since it is a continuous
phenotype, Explained Variance is considered to assess the performance
of the PRS model. For binary phenotypes, we considered AUC to
evaluate the PRS performance.</p></li>
</ol>
<p><strong>Note:</strong> We will divide the data into training and test sets, perform
quality controls on the training data. The data for each fold will be
saved separately for further processing. .</p>
<section id="pruning">
<h3>Pruning<a class="headerlink" href="#pruning" title="Link to this heading"></a></h3>
<p>Pruning is an integral part of the analysis, but it has been skipped as
a quality control on the training set for the following reasons. In our
initial analysis, we observed that pruning and clumping can affect the
performance of the polygenic risk score model. Rather than performing it
at this stage, we consider it as one of the hyperparameters and it will
be performed at a later stage. If we perform pruning at this stage, the
process that passed the pruning step would limit us to use other values
for pruning at the latest stage. However, even at the latest stage,
pruning is only performed on the training set.</p>
</section>
<section id="cross-validation-designs">
<h3>Cross-validation Designs<a class="headerlink" href="#cross-validation-designs" title="Link to this heading"></a></h3>
<p>There are multiple ways of doing cross-validation design, and one of
them is to use all the cohorts except one for the training and then use
the last cohort as the validation set. We performed quality controls and
hyperparameter optimization on the training set and found the best
combination across all folds, reporting the performance of the best
hyperparameter combination on the test set.</p>
</section>
<section id="a-simple-analysis">
<h3>A Simple Analysis<a class="headerlink" href="#a-simple-analysis" title="Link to this heading"></a></h3>
<p>If you have a separate GWAS file and our training data that you will be
using to optimize the hyperparameter on a subset without
cross-validation, then follow the original tutorial presented in the
first cell <a class="reference external" href="https://choishingwan.github.io/PRS-Tutorial/base/">Shing Wan Choi’s PRS
Tutorial</a>.</p>
<p><strong>Quality Controls considered for Training Data:</strong> 1. GWAS studies,
e.g., removing SNPs with low genotyping rate, low minor allele
frequency, out of Hardy-Weinberg Equilibrium, removing individuals with
low genotyping rate. 2. Pruning was skipped. 3. Heterozygosity check. 4.
Sex chromosomes. 5. Relatedness.</p>
<p><strong>R Script - Module1.R</strong></p>
<p>This file contains the code presented in this
<a class="reference external" href="https://choishingwan.github.io/PRS-Tutorial/base/">tutorial</a> to
assist in performing quality controls on the training data. Kindly,
follow their instructions for better understanding, as quality controls
are not the main focus of this research.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">FileLink</span>

<span class="c1"># R file used in to execute the following code.</span>
<span class="n">FileLink</span><span class="p">(</span><span class="s1">&#39;Module1.R&#39;</span><span class="p">)</span>
</pre></div>
</div>
<a href='Module1.R' target='_blank'>Module1.R</a><br><p><strong>R Script - Module1.R</strong></p>
<p>This file contains the code presented in this [tutorial](<a class="reference external" href="https://choishingwan.github.io/PRS-Tutorial/base/">https://choishingwan.github.io/PRS-Tutorial/base/</a>) to assist in performing quality controls on the training data. Kindly, follow their instructions for better understanding, as quality controls are not the main focus of this research.</p>
<p>args &lt;- commandArgs(trailingOnly = TRUE)
print(args)
# Argument one is going to be the directory.
# Argument two is going to be the file name.
# Argument three is going to be the output file name.
# Argument four is going to be the specific function to be called.</p>
<p>if (args[4]==”1”){</p>
<blockquote>
<div><p>result &lt;-paste(“.”,args[1],paste(args[3],toString(“.het”), sep = “”),sep=”//”)
dat &lt;- read.table(result, header=T) # Read in the EUR.het file, specify it has header
m &lt;- mean(dat$F) # Calculate the mean
s &lt;- sd(dat$F) # Calculate the SD
valid &lt;- subset(dat, F &lt;= m+3*s &amp; F &gt;= m-3*s) # Get any samples with F coefficient within 3 SD of the population mean
result &lt;-paste(“./”,args[1],paste(args[2],toString(“.valid.sample”), sep = “”),sep=”//”)
write.table(valid[,c(1,2)], result, quote=F, row.names=F) # print FID and IID for valid samples
result &lt;-paste(“./”,args[1],paste(args[2],toString(“.bim”), sep = “”),sep=”//”)
bim &lt;- read.table(result)</p>
<p>colnames(bim) &lt;- c(“CHR”, “SNP”, “CM”, “BP”, “B.A1”, “B.A2”)</p>
<p># Read in QCed SNPs
result &lt;-paste(“./”,args[1],paste(args[3],toString(“.snplist”), sep = “”),sep=”//”)</p>
<p>qc &lt;- read.table(result, header = F, stringsAsFactors = F)
# Read in the GWAS data
path_parts &lt;- strsplit(args[1], “/<a href="#id1"><span class="problematic" id="id2">|</span></a>\\”)[[1]]
print(path_parts)
print(path_parts[1])
result &lt;-paste(“./”,path_parts[1],paste(path_parts[1],toString(“.gz”), sep = “”),sep=”//”)
#result &lt;-paste(“./”,args[1],”train”,toString(“train.assoc.fisher”),sep=”//”)</p>
<dl class="simple">
<dt>height &lt;-read.table(gzfile(result),</dt><dd><p>header = T,
stringsAsFactors = F,
sep=”t”)</p>
</dd>
</dl>
<p># Change all alleles to upper case for easy comparison</p>
<p>height$A1 &lt;- toupper(height$A1)
height$A2 &lt;- toupper(height$A2)
bim$B.A1 &lt;- toupper(bim$B.A1)
bim$B.A2 &lt;- toupper(bim$B.A2)
info &lt;- merge(bim, height, by = c(“SNP”, “CHR”, “BP”))
# Filter QCed SNPs
print(length(info))</p>
<p>info &lt;- info[info$SNP %in% qc$V1,]
print(length(info))
# Function for finding the complementary allele</p>
<dl>
<dt>complement &lt;- function(x) {</dt><dd><dl class="simple">
<dt>switch (</dt><dd><p>x,
“A” = “T”,
“C” = “G”,
“T” = “A”,
“G” = “C”,
return(NA)</p>
</dd>
</dl>
<p>)</p>
</dd>
</dl>
<p>}</p>
<p># Get SNPs that have the same alleles across base and target
info.match &lt;- subset(info, A1 == B.A1 &amp; A2 == B.A2)
print(length(info.match))</p>
<p># Identify SNPs that are complementary between base and target
info$C.A1 &lt;- sapply(info$B.A1, complement)
info$C.A2 &lt;- sapply(info$B.A2, complement)
info.complement &lt;- subset(info, A1 == C.A1 &amp; A2 == C.A2)
# Update the complementary alleles in the bim file
# This allow us to match the allele in subsequent analysis</p>
<p>complement.snps &lt;- bim$SNP %in% info.complement$SNP
bim[complement.snps,]$B.A1 &lt;-</p>
<blockquote>
<div><p>sapply(bim[complement.snps,]$B.A1, complement)</p>
</div></blockquote>
<dl class="simple">
<dt>bim[complement.snps,]$B.A2 &lt;-</dt><dd><p>sapply(bim[complement.snps,]$B.A2, complement)</p>
</dd>
</dl>
<p># identify SNPs that need recoding
info.recode &lt;- subset(info, A1 == B.A2 &amp; A2 == B.A1)
# Update the recode SNPs
recode.snps &lt;- bim$SNP %in% info.recode$SNP
tmp &lt;- bim[recode.snps,]$B.A1
bim[recode.snps,]$B.A1 &lt;- bim[recode.snps,]$B.A2
bim[recode.snps,]$B.A2 &lt;- tmp</p>
<p># identify SNPs that need recoding &amp; complement
info.crecode &lt;- subset(info, A1 == C.A2 &amp; A2 == C.A1)
# Update the recode + strand flip SNPs
com.snps &lt;- bim$SNP %in% info.crecode$SNP
tmp &lt;- bim[com.snps,]$B.A1
bim[com.snps,]$B.A1 &lt;- as.character(sapply(bim[com.snps,]$B.A2, complement))
bim[com.snps,]$B.A2 &lt;- as.character(sapply(tmp, complement))
result &lt;-paste(“./”,args[1],paste(args[2],toString(“.a1”), sep = “”),sep=”//”)</p>
<p># Output updated bim file
write.table(</p>
<blockquote>
<div><p>bim[,c(“SNP”, “B.A1”)],
result,
quote = F,
row.names = F,
col.names = F,
sep=”t”</p>
</div></blockquote>
<p>)
mismatch &lt;-</p>
<blockquote>
<div><dl class="simple">
<dt>bim$SNP[!(bim$SNP %in% info.match$SNP |</dt><dd><p>bim$SNP %in% info.complement$SNP |
bim$SNP %in% info.recode$SNP |
bim$SNP %in% info.crecode$SNP)]</p>
</dd>
</dl>
</div></blockquote>
<p>result &lt;-paste(“./”,args[1],paste(args[2],toString(“.mismatch”), sep = “”),sep=”//”)</p>
<dl class="simple">
<dt>write.table(</dt><dd><p>mismatch,
result,
quote = F,
row.names = F,
col.names = F</p>
</dd>
</dl>
<p>)</p>
</div></blockquote>
<p>}
if (args[4]==”2”){</p>
<blockquote>
<div><p>result &lt;-paste(“./”,args[1],paste(args[2],toString(“.valid.sample”), sep = “”),sep=”//”)
valid &lt;- read.table(result, header=T)
result &lt;-paste(“./”,args[1],paste(args[3],toString(“.sexcheck”), sep = “”),sep=”//”)
dat &lt;- read.table(result, header=T)
valid &lt;- subset(dat, STATUS==”OK” &amp; FID %in% valid$FID)
result &lt;-paste(“./”,args[1],paste(args[3],toString(“.valid”), sep = “”),sep=”//”)
print(result)
write.table(valid[,c(“FID”, “IID”)], result, row.names=F, col.names=F, sep=”t”, quote=F)</p>
</div></blockquote>
<p>}</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">StratifiedKFold</span>
<span class="kn">import</span> <span class="nn">subprocess</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">KFold</span><span class="p">,</span> <span class="n">cross_val_score</span>

<span class="c1"># Step 1: Read the Fam file</span>

<span class="n">input_file_path</span> <span class="o">=</span> <span class="n">filedirec</span><span class="o">+</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="o">+</span><span class="n">newfilename</span><span class="o">+</span><span class="s1">&#39;.fam&#39;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">input_file_path</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s2">&quot;\s+&quot;</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

<span class="c1"># Step 2: Create 5 directories for storing fold information</span>
<span class="n">output_directory_base</span> <span class="o">=</span> <span class="n">filedirec</span>
<span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">output_directory_base</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Step 3: Split the data into 5 folds using cross validation</span>
<span class="n">fold_column</span> <span class="o">=</span> <span class="mi">5</span>  <span class="c1"># fifth column contains phenotypes</span>
<span class="n">kf</span> <span class="o">=</span> <span class="n">KFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">phenotype_col</span> <span class="o">=</span> <span class="mi">5</span>

<span class="c1"># The following code is for binary phenotype.</span>
<span class="n">skf</span> <span class="o">=</span> <span class="n">StratifiedKFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">column_values</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">phenotype_col</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>

<span class="k">if</span> <span class="nb">set</span><span class="p">(</span><span class="n">column_values</span><span class="p">)</span> <span class="o">==</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">}:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The column contains only 0 and 1.&quot;</span><span class="p">)</span>
    <span class="c1">#exit(0)</span>
    <span class="k">for</span> <span class="n">fold_id</span><span class="p">,</span> <span class="p">(</span><span class="n">train_index</span><span class="p">,</span> <span class="n">test_index</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">skf</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="n">phenotype_col</span><span class="p">])):</span>
        <span class="n">fold_directory</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_directory_base</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Fold_</span><span class="si">{</span><span class="n">fold_id</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="n">train_file_name</span> <span class="o">=</span> <span class="s2">&quot;train_data&quot;</span>
        <span class="n">test_file_name</span> <span class="o">=</span> <span class="s2">&quot;test_data&quot;</span>

        <span class="n">new_train_file_name</span> <span class="o">=</span> <span class="s2">&quot;train_data.QC&quot;</span>
        <span class="n">new_test_file_name</span> <span class="o">=</span> <span class="s2">&quot;test_data.QC&quot;</span>

        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">fold_directory</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1">#&quot;&quot;&quot;</span>
        <span class="c1"># Save train and test data to separate CSV files</span>
        <span class="n">train_data</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">train_index</span><span class="p">]</span>
        <span class="n">test_data</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">test_index</span><span class="p">]</span>

        <span class="n">train_data</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fold_directory</span><span class="p">,</span> <span class="s1">&#39;train_data.fam&#39;</span><span class="p">),</span><span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">test_data</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fold_directory</span><span class="p">,</span> <span class="s1">&#39;test_data.fam&#39;</span><span class="p">),</span><span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="c1">#print(train_data)</span>
        <span class="c1">#exit(0)</span>

        <span class="c1">#exit(0)</span>
        <span class="c1"># Step 4: Use PLINK to extract test and train samples for each fold</span>
        <span class="n">plink_train_command</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;./plink&#39;</span><span class="p">,</span>
            <span class="s1">&#39;--bfile&#39;</span><span class="p">,</span> <span class="n">filedirec</span><span class="o">+</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="o">+</span><span class="n">newfilename</span><span class="p">,</span>
            <span class="s1">&#39;--keep&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fold_directory</span><span class="p">,</span> <span class="n">train_file_name</span><span class="o">+</span><span class="s1">&#39;.fam&#39;</span><span class="p">),</span>
            <span class="s1">&#39;--make-bed&#39;</span><span class="p">,</span>
            <span class="s1">&#39;--out&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fold_directory</span><span class="p">,</span> <span class="n">train_file_name</span><span class="p">)</span>
        <span class="p">]</span>

        <span class="n">plink_test_command</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;./plink&#39;</span><span class="p">,</span>
            <span class="s1">&#39;--bfile&#39;</span><span class="p">,</span> <span class="n">filedirec</span><span class="o">+</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="o">+</span><span class="n">newfilename</span><span class="p">,</span>
            <span class="s1">&#39;--keep&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fold_directory</span><span class="p">,</span> <span class="n">test_file_name</span><span class="o">+</span><span class="s1">&#39;.fam&#39;</span><span class="p">),</span>
            <span class="s1">&#39;--make-bed&#39;</span><span class="p">,</span>
            <span class="s1">&#39;--out&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fold_directory</span><span class="p">,</span> <span class="n">test_file_name</span><span class="p">)</span>
        <span class="p">]</span>

        <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">plink_train_command</span><span class="p">)</span>
        <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">plink_test_command</span><span class="p">)</span>

        <span class="n">covfile</span> <span class="o">=</span> <span class="n">filedirec</span><span class="o">+</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="o">+</span><span class="n">newfilename</span><span class="o">+</span><span class="s1">&#39;.cov&#39;</span>
        <span class="n">covfile</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">covfile</span><span class="p">)</span>

        <span class="n">cov_train_data</span> <span class="o">=</span> <span class="n">covfile</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">train_index</span><span class="p">]</span>
        <span class="n">cov_test_data</span> <span class="o">=</span> <span class="n">covfile</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">test_index</span><span class="p">]</span>

        <span class="n">cov_train_data</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fold_directory</span><span class="p">,</span> <span class="n">train_file_name</span><span class="o">+</span><span class="s1">&#39;.cov&#39;</span><span class="p">),</span><span class="n">sep</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">cov_test_data</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fold_directory</span><span class="p">,</span> <span class="n">test_file_name</span><span class="o">+</span><span class="s1">&#39;.cov&#39;</span><span class="p">),</span><span class="n">sep</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1">#exit(0)</span>
        <span class="c1">### perform Quality controls on the training data only.</span>
        <span class="n">plink_command_1</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;./plink&#39;</span><span class="p">,</span>
            <span class="s1">&#39;--bfile&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fold_directory</span><span class="p">,</span> <span class="n">train_file_name</span><span class="p">),</span>
            <span class="s1">&#39;--maf&#39;</span><span class="p">,</span> <span class="s1">&#39;0.01&#39;</span><span class="p">,</span>
            <span class="s1">&#39;--hwe&#39;</span><span class="p">,</span> <span class="s1">&#39;1e-6&#39;</span><span class="p">,</span>
            <span class="s1">&#39;--geno&#39;</span><span class="p">,</span> <span class="s1">&#39;0.1&#39;</span><span class="p">,</span>
            <span class="s1">&#39;--mind&#39;</span><span class="p">,</span> <span class="s1">&#39;0.1&#39;</span><span class="p">,</span>
            <span class="s1">&#39;--write-snplist&#39;</span><span class="p">,</span>
            <span class="s1">&#39;--make-just-fam&#39;</span><span class="p">,</span>
            <span class="s1">&#39;--out&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fold_directory</span><span class="p">,</span> <span class="n">new_train_file_name</span><span class="p">)</span>
        <span class="p">]</span>

        <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">plink_command_1</span><span class="p">)</span>

        <span class="c1"># Command 2</span>
        <span class="c1"># Perform pruning. Skip it.</span>
        <span class="n">plink_command_2</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;./plink&#39;</span><span class="p">,</span>
            <span class="s1">&#39;--bfile&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fold_directory</span><span class="p">,</span> <span class="n">train_file_name</span><span class="p">),</span>
            <span class="s1">&#39;--keep&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fold_directory</span><span class="p">,</span> <span class="n">new_train_file_name</span><span class="o">+</span><span class="s1">&#39;.fam&#39;</span><span class="p">),</span>
            <span class="s1">&#39;--extract&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fold_directory</span><span class="p">,</span> <span class="n">new_train_file_name</span><span class="o">+</span><span class="s1">&#39;.snplist&#39;</span><span class="p">),</span>
            <span class="s1">&#39;--indep-pairwise&#39;</span><span class="p">,</span> <span class="s1">&#39;200&#39;</span><span class="p">,</span> <span class="s1">&#39;50&#39;</span><span class="p">,</span> <span class="s1">&#39;0.25&#39;</span><span class="p">,</span>
            <span class="s1">&#39;--out&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fold_directory</span><span class="p">,</span> <span class="n">new_train_file_name</span><span class="p">)</span>
        <span class="p">]</span>

        <span class="c1">#subprocess.run(plink_command_2)</span>

        <span class="c1"># Command 3</span>
        <span class="n">plink_command_3</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;./plink&#39;</span><span class="p">,</span>
            <span class="s1">&#39;--bfile&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fold_directory</span><span class="p">,</span> <span class="n">train_file_name</span><span class="p">),</span>
            <span class="c1">#&#39;--extract&#39;, os.path.join(fold_directory, new_train_file_name+&#39;.prune.in&#39;),</span>
            <span class="s1">&#39;--extract&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fold_directory</span><span class="p">,</span> <span class="n">new_train_file_name</span><span class="o">+</span><span class="s1">&#39;.snplist&#39;</span><span class="p">),</span>
            <span class="s1">&#39;--keep&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fold_directory</span><span class="p">,</span> <span class="n">new_train_file_name</span><span class="o">+</span><span class="s1">&#39;.fam&#39;</span><span class="p">),</span>
            <span class="s1">&#39;--het&#39;</span><span class="p">,</span>
            <span class="s1">&#39;--out&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fold_directory</span><span class="p">,</span> <span class="n">new_train_file_name</span><span class="p">)</span>
        <span class="p">]</span>

        <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">plink_command_3</span><span class="p">)</span>
        <span class="c1"># Invoked R functions.</span>

        <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;Rscript Module1.R &quot;</span><span class="o">+</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fold_directory</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;  &quot;</span><span class="o">+</span><span class="n">train_file_name</span><span class="o">+</span><span class="s2">&quot; &quot;</span><span class="o">+</span><span class="n">new_train_file_name</span><span class="o">+</span> <span class="s2">&quot; &quot;</span><span class="o">+</span><span class="s2">&quot;1&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Rscript Module1.R &quot;</span><span class="o">+</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fold_directory</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;  &quot;</span><span class="o">+</span><span class="n">train_file_name</span><span class="o">+</span><span class="s2">&quot; &quot;</span><span class="o">+</span><span class="n">new_train_file_name</span><span class="o">+</span> <span class="s2">&quot; &quot;</span><span class="o">+</span><span class="s2">&quot;1&quot;</span><span class="p">)</span>


        <span class="c1"># Code for sex check: The sample data have 22 chromosomes, so this operation is skipped.</span>
        <span class="c1"># If the Chromosome X is not available, then do not execute the following two commands.</span>
        <span class="n">plink_command</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;./plink&#39;</span><span class="p">,</span>
        <span class="s1">&#39;--bfile&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fold_directory</span><span class="p">,</span> <span class="s1">&#39;train_data&#39;</span><span class="p">),</span>
        <span class="c1">#&#39;--extract&#39;, os.path.join(fold_directory, &#39;train_data.QC.prune.in&#39;),</span>
        <span class="s1">&#39;--extract&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fold_directory</span><span class="p">,</span> <span class="n">new_train_file_name</span><span class="o">+</span><span class="s1">&#39;.snplist&#39;</span><span class="p">),</span>
        <span class="s1">&#39;--keep&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fold_directory</span><span class="p">,</span> <span class="s1">&#39;train_data.valid.sample&#39;</span><span class="p">),</span>
        <span class="s1">&#39;--check-sex&#39;</span><span class="p">,</span>
        <span class="s1">&#39;--out&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fold_directory</span><span class="p">,</span> <span class="s1">&#39;train_data.QC&#39;</span><span class="p">)</span>
        <span class="p">]</span>

        <span class="c1"># Invoke the PLINK command using subprocess for sex check</span>
        <span class="c1">#subprocess.run(plink_command)</span>
        <span class="c1">#os.system(&quot;Rscript Module1.R &quot;+os.path.join(fold_directory)+&quot;  &quot;+train_file_name+&quot; &quot;+new_train_file_name+ &quot; &quot;+&quot;2&quot;)</span>

        <span class="c1">#&quot;&quot;&quot;</span>

        <span class="n">plink_command_1</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;./plink&#39;</span><span class="p">,</span>
        <span class="s1">&#39;--bfile&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fold_directory</span><span class="p">,</span> <span class="n">train_file_name</span><span class="p">),</span>
        <span class="c1">#&#39;--extract&#39;, os.path.join(fold_directory, new_train_file_name+&#39;.prune.in&#39;),</span>
        <span class="c1"># If you use sex check, then use the following line. Otherwise, it is not required.</span>
        <span class="s1">&#39;--extract&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fold_directory</span><span class="p">,</span> <span class="n">new_train_file_name</span><span class="o">+</span><span class="s1">&#39;.snplist&#39;</span><span class="p">),</span>

        <span class="c1"># Uncomment the following line if the sex Chromosome is available.</span>
        <span class="c1"># Kindly not, if you perform Sex check, and some people are removed, you have to</span>
        <span class="c1"># remove people from covariate file and Phenotype file.</span>

        <span class="c1">#&#39;--keep&#39;, os.path.join(fold_directory, &#39;train_data.QC.valid&#39;),</span>
        <span class="s1">&#39;--rel-cutoff&#39;</span><span class="p">,</span> <span class="s1">&#39;0.125&#39;</span><span class="p">,</span>
        <span class="s1">&#39;--out&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fold_directory</span><span class="p">,</span> <span class="n">new_train_file_name</span><span class="p">)</span>
        <span class="p">]</span>

        <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">plink_command_1</span><span class="p">)</span>


        <span class="n">plink_command_2</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;./plink&#39;</span><span class="p">,</span>
            <span class="s1">&#39;--bfile&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fold_directory</span><span class="p">,</span> <span class="n">train_file_name</span><span class="p">),</span>
            <span class="s1">&#39;--make-bed&#39;</span><span class="p">,</span>
            <span class="s1">&#39;--keep&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fold_directory</span><span class="p">,</span> <span class="n">new_train_file_name</span><span class="o">+</span><span class="s1">&#39;.rel.id&#39;</span><span class="p">),</span>
            <span class="s1">&#39;--out&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fold_directory</span><span class="p">,</span> <span class="n">new_train_file_name</span><span class="p">),</span>
            <span class="s1">&#39;--extract&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fold_directory</span><span class="p">,</span> <span class="n">new_train_file_name</span><span class="o">+</span><span class="s1">&#39;.snplist&#39;</span><span class="p">),</span>
            <span class="s1">&#39;--exclude&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fold_directory</span><span class="p">,</span> <span class="n">train_file_name</span><span class="o">+</span><span class="s1">&#39;.mismatch&#39;</span><span class="p">),</span>
            <span class="s1">&#39;--a1-allele&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fold_directory</span><span class="p">,</span> <span class="n">train_file_name</span><span class="o">+</span><span class="s1">&#39;.a1&#39;</span><span class="p">)</span>
        <span class="p">]</span>

        <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">plink_command_2</span><span class="p">)</span>

<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The column does not contain only 0 and 1.&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">fold_id</span><span class="p">,</span> <span class="p">(</span><span class="n">train_index</span><span class="p">,</span> <span class="n">test_index</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">kf</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="n">phenotype_col</span><span class="p">])):</span>
        <span class="n">fold_directory</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_directory_base</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Fold_</span><span class="si">{</span><span class="n">fold_id</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="n">train_file_name</span> <span class="o">=</span> <span class="s2">&quot;train_data&quot;</span>
        <span class="n">test_file_name</span> <span class="o">=</span> <span class="s2">&quot;test_data&quot;</span>

        <span class="n">new_train_file_name</span> <span class="o">=</span> <span class="s2">&quot;train_data.QC&quot;</span>
        <span class="n">new_test_file_name</span> <span class="o">=</span> <span class="s2">&quot;test_data.QC&quot;</span>

        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">fold_directory</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1">#&quot;&quot;&quot;</span>
        <span class="c1"># Save train and test data to separate CSV files</span>
        <span class="n">train_data</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">train_index</span><span class="p">]</span>
        <span class="n">test_data</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">test_index</span><span class="p">]</span>

        <span class="n">train_data</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fold_directory</span><span class="p">,</span> <span class="s1">&#39;train_data.fam&#39;</span><span class="p">),</span><span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">test_data</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fold_directory</span><span class="p">,</span> <span class="s1">&#39;test_data.fam&#39;</span><span class="p">),</span><span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="c1">#print(train_data)</span>
        <span class="c1">#exit(0)</span>

        <span class="c1">#exit(0)</span>
        <span class="c1"># Step 4: Use PLINK to extract test and train samples for each fold</span>
        <span class="n">plink_train_command</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;./plink&#39;</span><span class="p">,</span>
            <span class="s1">&#39;--bfile&#39;</span><span class="p">,</span> <span class="n">filedirec</span><span class="o">+</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="o">+</span><span class="n">newfilename</span><span class="p">,</span>
            <span class="s1">&#39;--keep&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fold_directory</span><span class="p">,</span> <span class="n">train_file_name</span><span class="o">+</span><span class="s1">&#39;.fam&#39;</span><span class="p">),</span>
            <span class="s1">&#39;--make-bed&#39;</span><span class="p">,</span>
            <span class="s1">&#39;--out&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fold_directory</span><span class="p">,</span> <span class="n">train_file_name</span><span class="p">)</span>
        <span class="p">]</span>

        <span class="n">plink_test_command</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;./plink&#39;</span><span class="p">,</span>
            <span class="s1">&#39;--bfile&#39;</span><span class="p">,</span> <span class="n">filedirec</span><span class="o">+</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="o">+</span><span class="n">newfilename</span><span class="p">,</span>
            <span class="s1">&#39;--keep&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fold_directory</span><span class="p">,</span> <span class="n">test_file_name</span><span class="o">+</span><span class="s1">&#39;.fam&#39;</span><span class="p">),</span>
            <span class="s1">&#39;--make-bed&#39;</span><span class="p">,</span>
            <span class="s1">&#39;--out&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fold_directory</span><span class="p">,</span> <span class="n">test_file_name</span><span class="p">)</span>
        <span class="p">]</span>

        <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">plink_train_command</span><span class="p">)</span>
        <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">plink_test_command</span><span class="p">)</span>

        <span class="n">covfile</span> <span class="o">=</span> <span class="n">filedirec</span><span class="o">+</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="o">+</span><span class="n">newfilename</span><span class="o">+</span><span class="s1">&#39;.cov&#39;</span>
        <span class="n">covfile</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">covfile</span><span class="p">)</span>

        <span class="n">cov_train_data</span> <span class="o">=</span> <span class="n">covfile</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">train_index</span><span class="p">]</span>
        <span class="n">cov_test_data</span> <span class="o">=</span> <span class="n">covfile</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">test_index</span><span class="p">]</span>

        <span class="n">cov_train_data</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fold_directory</span><span class="p">,</span> <span class="n">train_file_name</span><span class="o">+</span><span class="s1">&#39;.cov&#39;</span><span class="p">),</span><span class="n">sep</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">cov_test_data</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fold_directory</span><span class="p">,</span> <span class="n">test_file_name</span><span class="o">+</span><span class="s1">&#39;.cov&#39;</span><span class="p">),</span><span class="n">sep</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1">#exit(0)</span>
        <span class="c1">### perform Quality controls on the training data only.</span>
        <span class="n">plink_command_1</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;./plink&#39;</span><span class="p">,</span>
            <span class="s1">&#39;--bfile&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fold_directory</span><span class="p">,</span> <span class="n">train_file_name</span><span class="p">),</span>
            <span class="s1">&#39;--maf&#39;</span><span class="p">,</span> <span class="s1">&#39;0.01&#39;</span><span class="p">,</span>
            <span class="s1">&#39;--hwe&#39;</span><span class="p">,</span> <span class="s1">&#39;1e-6&#39;</span><span class="p">,</span>
            <span class="s1">&#39;--geno&#39;</span><span class="p">,</span> <span class="s1">&#39;0.1&#39;</span><span class="p">,</span>
            <span class="s1">&#39;--mind&#39;</span><span class="p">,</span> <span class="s1">&#39;0.1&#39;</span><span class="p">,</span>
            <span class="s1">&#39;--write-snplist&#39;</span><span class="p">,</span>
            <span class="s1">&#39;--make-just-fam&#39;</span><span class="p">,</span>
            <span class="s1">&#39;--out&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fold_directory</span><span class="p">,</span> <span class="n">new_train_file_name</span><span class="p">)</span>
        <span class="p">]</span>

        <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">plink_command_1</span><span class="p">)</span>

        <span class="c1"># Command 2</span>
        <span class="n">plink_command_2</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;./plink&#39;</span><span class="p">,</span>
            <span class="s1">&#39;--bfile&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fold_directory</span><span class="p">,</span> <span class="n">train_file_name</span><span class="p">),</span>
            <span class="s1">&#39;--keep&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fold_directory</span><span class="p">,</span> <span class="n">new_train_file_name</span><span class="o">+</span><span class="s1">&#39;.fam&#39;</span><span class="p">),</span>
            <span class="s1">&#39;--extract&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fold_directory</span><span class="p">,</span> <span class="n">new_train_file_name</span><span class="o">+</span><span class="s1">&#39;.snplist&#39;</span><span class="p">),</span>
            <span class="s1">&#39;--indep-pairwise&#39;</span><span class="p">,</span> <span class="s1">&#39;200&#39;</span><span class="p">,</span> <span class="s1">&#39;50&#39;</span><span class="p">,</span> <span class="s1">&#39;0.25&#39;</span><span class="p">,</span>
            <span class="s1">&#39;--out&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fold_directory</span><span class="p">,</span> <span class="n">new_train_file_name</span><span class="p">)</span>
        <span class="p">]</span>

        <span class="c1">#subprocess.run(plink_command_2)</span>

        <span class="c1"># Command 3</span>
        <span class="n">plink_command_3</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;./plink&#39;</span><span class="p">,</span>
            <span class="s1">&#39;--bfile&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fold_directory</span><span class="p">,</span> <span class="n">train_file_name</span><span class="p">),</span>
            <span class="c1">#&#39;--extract&#39;, os.path.join(fold_directory, new_train_file_name+&#39;.prune.in&#39;),</span>
            <span class="s1">&#39;--extract&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fold_directory</span><span class="p">,</span> <span class="n">new_train_file_name</span><span class="o">+</span><span class="s1">&#39;.snplist&#39;</span><span class="p">),</span>
            <span class="s1">&#39;--keep&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fold_directory</span><span class="p">,</span> <span class="n">new_train_file_name</span><span class="o">+</span><span class="s1">&#39;.fam&#39;</span><span class="p">),</span>
            <span class="s1">&#39;--het&#39;</span><span class="p">,</span>
            <span class="s1">&#39;--out&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fold_directory</span><span class="p">,</span> <span class="n">new_train_file_name</span><span class="p">)</span>
        <span class="p">]</span>

        <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">plink_command_3</span><span class="p">)</span>
        <span class="c1"># Invoked R functions.</span>

        <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;Rscript Module1.R &quot;</span><span class="o">+</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fold_directory</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;  &quot;</span><span class="o">+</span><span class="n">train_file_name</span><span class="o">+</span><span class="s2">&quot; &quot;</span><span class="o">+</span><span class="n">new_train_file_name</span><span class="o">+</span> <span class="s2">&quot; &quot;</span><span class="o">+</span><span class="s2">&quot;1&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Rscript Module1.R &quot;</span><span class="o">+</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fold_directory</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;  &quot;</span><span class="o">+</span><span class="n">train_file_name</span><span class="o">+</span><span class="s2">&quot; &quot;</span><span class="o">+</span><span class="n">new_train_file_name</span><span class="o">+</span> <span class="s2">&quot; &quot;</span><span class="o">+</span><span class="s2">&quot;1&quot;</span><span class="p">)</span>



        <span class="c1"># Code for sex check: The sample data have 22 chromosomes, so this operation is skipped.</span>
        <span class="c1"># If the Chromosome X is not available, then do not execute the following two commands.</span>
        <span class="c1">#&quot;&quot;&quot;</span>
        <span class="n">plink_command</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;./plink&#39;</span><span class="p">,</span>
        <span class="s1">&#39;--bfile&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fold_directory</span><span class="p">,</span> <span class="s1">&#39;train_data&#39;</span><span class="p">),</span>
        <span class="c1">#&#39;--extract&#39;, os.path.join(fold_directory, &#39;train_data.QC.prune.in&#39;),</span>
        <span class="s1">&#39;--extract&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fold_directory</span><span class="p">,</span> <span class="n">new_train_file_name</span><span class="o">+</span><span class="s1">&#39;.snplist&#39;</span><span class="p">),</span>
        <span class="s1">&#39;--keep&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fold_directory</span><span class="p">,</span> <span class="s1">&#39;train_data.valid.sample&#39;</span><span class="p">),</span>
        <span class="s1">&#39;--check-sex&#39;</span><span class="p">,</span>
        <span class="s1">&#39;--out&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fold_directory</span><span class="p">,</span> <span class="s1">&#39;train_data.QC&#39;</span><span class="p">)</span>
        <span class="p">]</span>

        <span class="c1"># Invoke the PLINK command using subprocess for sex check</span>

        <span class="c1">#subprocess.run(plink_command)</span>
        <span class="c1">#os.system(&quot;Rscript Module1.R &quot;+os.path.join(fold_directory)+&quot;  &quot;+train_file_name+&quot; &quot;+new_train_file_name+ &quot; &quot;+&quot;2&quot;)</span>

        <span class="c1">#&quot;&quot;&quot;</span>

        <span class="n">plink_command_1</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;./plink&#39;</span><span class="p">,</span>
        <span class="s1">&#39;--bfile&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fold_directory</span><span class="p">,</span> <span class="n">train_file_name</span><span class="p">),</span>
        <span class="c1">#&#39;--extract&#39;, os.path.join(fold_directory, new_train_file_name+&#39;.prune.in&#39;),</span>
        <span class="c1"># If you use sex check then use the following line. Otherwise it is not required.</span>
        <span class="s1">&#39;--extract&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fold_directory</span><span class="p">,</span> <span class="n">new_train_file_name</span><span class="o">+</span><span class="s1">&#39;.snplist&#39;</span><span class="p">),</span>
        <span class="c1">#&#39;--keep&#39;, os.path.join(fold_directory, &#39;train_data.QC.valid&#39;),</span>
        <span class="s1">&#39;--rel-cutoff&#39;</span><span class="p">,</span> <span class="s1">&#39;0.125&#39;</span><span class="p">,</span>
        <span class="s1">&#39;--out&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fold_directory</span><span class="p">,</span> <span class="n">new_train_file_name</span><span class="p">)</span>
        <span class="p">]</span>

        <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">plink_command_1</span><span class="p">)</span>
        <span class="c1">#exit(0)</span>

        <span class="c1">#exit(0)</span>
        <span class="c1"># Command 2</span>
        <span class="n">plink_command_2</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;./plink&#39;</span><span class="p">,</span>
            <span class="s1">&#39;--bfile&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fold_directory</span><span class="p">,</span> <span class="n">train_file_name</span><span class="p">),</span>
            <span class="s1">&#39;--make-bed&#39;</span><span class="p">,</span>
            <span class="s1">&#39;--keep&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fold_directory</span><span class="p">,</span> <span class="n">new_train_file_name</span><span class="o">+</span><span class="s1">&#39;.rel.id&#39;</span><span class="p">),</span>
            <span class="s1">&#39;--out&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fold_directory</span><span class="p">,</span> <span class="n">new_train_file_name</span><span class="p">),</span>
            <span class="s1">&#39;--extract&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fold_directory</span><span class="p">,</span> <span class="n">new_train_file_name</span><span class="o">+</span><span class="s1">&#39;.snplist&#39;</span><span class="p">),</span>
            <span class="s1">&#39;--exclude&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fold_directory</span><span class="p">,</span> <span class="n">train_file_name</span><span class="o">+</span><span class="s1">&#39;.mismatch&#39;</span><span class="p">),</span>
            <span class="s1">&#39;--a1-allele&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fold_directory</span><span class="p">,</span> <span class="n">train_file_name</span><span class="o">+</span><span class="s1">&#39;.a1&#39;</span><span class="p">)</span>
        <span class="p">]</span>

        <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">plink_command_2</span><span class="p">)</span>
        <span class="c1">#exit(0)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">The</span> <span class="n">column</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">contain</span> <span class="n">only</span> <span class="mi">0</span> <span class="ow">and</span> <span class="mf">1.</span>
<span class="n">PLINK</span> <span class="n">v1</span><span class="mf">.90</span><span class="n">b7</span><span class="mf">.2</span> <span class="mi">64</span><span class="o">-</span><span class="n">bit</span> <span class="p">(</span><span class="mi">11</span> <span class="n">Dec</span> <span class="mi">2023</span><span class="p">)</span>           <span class="n">www</span><span class="o">.</span><span class="n">cog</span><span class="o">-</span><span class="n">genomics</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">plink</span><span class="o">/</span><span class="mf">1.9</span><span class="o">/</span>
<span class="p">(</span><span class="n">C</span><span class="p">)</span> <span class="mi">2005</span><span class="o">-</span><span class="mi">2023</span> <span class="n">Shaun</span> <span class="n">Purcell</span><span class="p">,</span> <span class="n">Christopher</span> <span class="n">Chang</span>   <span class="n">GNU</span> <span class="n">General</span> <span class="n">Public</span> <span class="n">License</span> <span class="n">v3</span>
<span class="n">Logging</span> <span class="n">to</span> <span class="n">SampleData1</span><span class="o">/</span><span class="n">Fold_0</span><span class="o">/</span><span class="n">train_data</span><span class="o">.</span><span class="n">log</span><span class="o">.</span>
<span class="n">Options</span> <span class="ow">in</span> <span class="n">effect</span><span class="p">:</span>
  <span class="o">--</span><span class="n">bfile</span> <span class="n">SampleData1</span><span class="o">/</span><span class="n">SampleData1_QC</span>
  <span class="o">--</span><span class="n">keep</span> <span class="n">SampleData1</span><span class="o">/</span><span class="n">Fold_0</span><span class="o">/</span><span class="n">train_data</span><span class="o">.</span><span class="n">fam</span>
  <span class="o">--</span><span class="n">make</span><span class="o">-</span><span class="n">bed</span>
  <span class="o">--</span><span class="n">out</span> <span class="n">SampleData1</span><span class="o">/</span><span class="n">Fold_0</span><span class="o">/</span><span class="n">train_data</span>

<span class="mi">63761</span> <span class="n">MB</span> <span class="n">RAM</span> <span class="n">detected</span><span class="p">;</span> <span class="n">reserving</span> <span class="mi">31880</span> <span class="n">MB</span> <span class="k">for</span> <span class="n">main</span> <span class="n">workspace</span><span class="o">.</span>
<span class="mi">551892</span> <span class="n">variants</span> <span class="n">loaded</span> <span class="kn">from</span> <span class="nn">.bim</span> <span class="n">file</span><span class="o">.</span>
<span class="mi">475</span> <span class="n">people</span> <span class="p">(</span><span class="mi">227</span> <span class="n">males</span><span class="p">,</span> <span class="mi">248</span> <span class="n">females</span><span class="p">)</span> <span class="n">loaded</span> <span class="kn">from</span> <span class="nn">.fam.</span>
<span class="mi">475</span> <span class="n">phenotype</span> <span class="n">values</span> <span class="n">loaded</span> <span class="kn">from</span> <span class="nn">.fam.</span>
<span class="o">--</span><span class="n">keep</span><span class="p">:</span> <span class="mi">380</span> <span class="n">people</span> <span class="n">remaining</span><span class="o">.</span>
<span class="n">Using</span> <span class="mi">1</span> <span class="n">thread</span> <span class="p">(</span><span class="n">no</span> <span class="n">multithreaded</span> <span class="n">calculations</span> <span class="n">invoked</span><span class="p">)</span><span class="o">.</span>
<span class="n">Before</span> <span class="n">main</span> <span class="n">variant</span> <span class="n">filters</span><span class="p">,</span> <span class="mi">380</span> <span class="n">founders</span> <span class="ow">and</span> <span class="mi">0</span> <span class="n">nonfounders</span> <span class="n">present</span><span class="o">.</span>
<span class="n">Calculating</span> <span class="n">allele</span> <span class="n">frequencies</span><span class="o">...</span> <span class="mi">10111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394959697989</span> <span class="n">done</span><span class="o">.</span>
<span class="n">Total</span> <span class="n">genotyping</span> <span class="n">rate</span> <span class="ow">in</span> <span class="n">remaining</span> <span class="n">samples</span> <span class="ow">is</span> <span class="mf">0.999896</span><span class="o">.</span>
<span class="mi">551892</span> <span class="n">variants</span> <span class="ow">and</span> <span class="mi">380</span> <span class="n">people</span> <span class="k">pass</span> <span class="n">filters</span> <span class="ow">and</span> <span class="n">QC</span><span class="o">.</span>
<span class="n">Phenotype</span> <span class="n">data</span> <span class="ow">is</span> <span class="n">quantitative</span><span class="o">.</span>
<span class="o">--</span><span class="n">make</span><span class="o">-</span><span class="n">bed</span> <span class="n">to</span> <span class="n">SampleData1</span><span class="o">/</span><span class="n">Fold_0</span><span class="o">/</span><span class="n">train_data</span><span class="o">.</span><span class="n">bed</span> <span class="o">+</span>
<span class="n">SampleData1</span><span class="o">/</span><span class="n">Fold_0</span><span class="o">/</span><span class="n">train_data</span><span class="o">.</span><span class="n">bim</span> <span class="o">+</span> <span class="n">SampleData1</span><span class="o">/</span><span class="n">Fold_0</span><span class="o">/</span><span class="n">train_data</span><span class="o">.</span><span class="n">fam</span> <span class="o">...</span> <span class="mi">101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899</span><span class="n">done</span><span class="o">.</span>
<span class="n">PLINK</span> <span class="n">v1</span><span class="mf">.90</span><span class="n">b7</span><span class="mf">.2</span> <span class="mi">64</span><span class="o">-</span><span class="n">bit</span> <span class="p">(</span><span class="mi">11</span> <span class="n">Dec</span> <span class="mi">2023</span><span class="p">)</span>           <span class="n">www</span><span class="o">.</span><span class="n">cog</span><span class="o">-</span><span class="n">genomics</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">plink</span><span class="o">/</span><span class="mf">1.9</span><span class="o">/</span>
<span class="p">(</span><span class="n">C</span><span class="p">)</span> <span class="mi">2005</span><span class="o">-</span><span class="mi">2023</span> <span class="n">Shaun</span> <span class="n">Purcell</span><span class="p">,</span> <span class="n">Christopher</span> <span class="n">Chang</span>   <span class="n">GNU</span> <span class="n">General</span> <span class="n">Public</span> <span class="n">License</span> <span class="n">v3</span>
<span class="n">Logging</span> <span class="n">to</span> <span class="n">SampleData1</span><span class="o">/</span><span class="n">Fold_0</span><span class="o">/</span><span class="n">test_data</span><span class="o">.</span><span class="n">log</span><span class="o">.</span>
<span class="n">Options</span> <span class="ow">in</span> <span class="n">effect</span><span class="p">:</span>
  <span class="o">--</span><span class="n">bfile</span> <span class="n">SampleData1</span><span class="o">/</span><span class="n">SampleData1_QC</span>
  <span class="o">--</span><span class="n">keep</span> <span class="n">SampleData1</span><span class="o">/</span><span class="n">Fold_0</span><span class="o">/</span><span class="n">test_data</span><span class="o">.</span><span class="n">fam</span>
  <span class="o">--</span><span class="n">make</span><span class="o">-</span><span class="n">bed</span>
  <span class="o">--</span><span class="n">out</span> <span class="n">SampleData1</span><span class="o">/</span><span class="n">Fold_0</span><span class="o">/</span><span class="n">test_data</span>

<span class="mi">63761</span> <span class="n">MB</span> <span class="n">RAM</span> <span class="n">detected</span><span class="p">;</span> <span class="n">reserving</span> <span class="mi">31880</span> <span class="n">MB</span> <span class="k">for</span> <span class="n">main</span> <span class="n">workspace</span><span class="o">.</span>
<span class="mi">551892</span> <span class="n">variants</span> <span class="n">loaded</span> <span class="kn">from</span> <span class="nn">.bim</span> <span class="n">file</span><span class="o">.</span>
<span class="mi">475</span> <span class="n">people</span> <span class="p">(</span><span class="mi">227</span> <span class="n">males</span><span class="p">,</span> <span class="mi">248</span> <span class="n">females</span><span class="p">)</span> <span class="n">loaded</span> <span class="kn">from</span> <span class="nn">.fam.</span>
<span class="mi">475</span> <span class="n">phenotype</span> <span class="n">values</span> <span class="n">loaded</span> <span class="kn">from</span> <span class="nn">.fam.</span>
<span class="o">--</span><span class="n">keep</span><span class="p">:</span> <span class="mi">95</span> <span class="n">people</span> <span class="n">remaining</span><span class="o">.</span>
<span class="n">Using</span> <span class="mi">1</span> <span class="n">thread</span> <span class="p">(</span><span class="n">no</span> <span class="n">multithreaded</span> <span class="n">calculations</span> <span class="n">invoked</span><span class="p">)</span><span class="o">.</span>
<span class="n">Before</span> <span class="n">main</span> <span class="n">variant</span> <span class="n">filters</span><span class="p">,</span> <span class="mi">95</span> <span class="n">founders</span> <span class="ow">and</span> <span class="mi">0</span> <span class="n">nonfounders</span> <span class="n">present</span><span class="o">.</span>
<span class="n">Calculating</span> <span class="n">allele</span> <span class="n">frequencies</span><span class="o">...</span> <span class="mi">10111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394959697989</span> <span class="n">done</span><span class="o">.</span>
<span class="n">Total</span> <span class="n">genotyping</span> <span class="n">rate</span> <span class="ow">in</span> <span class="n">remaining</span> <span class="n">samples</span> <span class="ow">is</span> <span class="mf">0.999896</span><span class="o">.</span>
<span class="mi">551892</span> <span class="n">variants</span> <span class="ow">and</span> <span class="mi">95</span> <span class="n">people</span> <span class="k">pass</span> <span class="n">filters</span> <span class="ow">and</span> <span class="n">QC</span><span class="o">.</span>
<span class="n">Phenotype</span> <span class="n">data</span> <span class="ow">is</span> <span class="n">quantitative</span><span class="o">.</span>
<span class="o">--</span><span class="n">make</span><span class="o">-</span><span class="n">bed</span> <span class="n">to</span> <span class="n">SampleData1</span><span class="o">/</span><span class="n">Fold_0</span><span class="o">/</span><span class="n">test_data</span><span class="o">.</span><span class="n">bed</span> <span class="o">+</span>
<span class="n">SampleData1</span><span class="o">/</span><span class="n">Fold_0</span><span class="o">/</span><span class="n">test_data</span><span class="o">.</span><span class="n">bim</span> <span class="o">+</span> <span class="n">SampleData1</span><span class="o">/</span><span class="n">Fold_0</span><span class="o">/</span><span class="n">test_data</span><span class="o">.</span><span class="n">fam</span> <span class="o">...</span> <span class="mi">101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899</span><span class="n">done</span><span class="o">.</span>
<span class="n">PLINK</span> <span class="n">v1</span><span class="mf">.90</span><span class="n">b7</span><span class="mf">.2</span> <span class="mi">64</span><span class="o">-</span><span class="n">bit</span> <span class="p">(</span><span class="mi">11</span> <span class="n">Dec</span> <span class="mi">2023</span><span class="p">)</span>           <span class="n">www</span><span class="o">.</span><span class="n">cog</span><span class="o">-</span><span class="n">genomics</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">plink</span><span class="o">/</span><span class="mf">1.9</span><span class="o">/</span>
<span class="p">(</span><span class="n">C</span><span class="p">)</span> <span class="mi">2005</span><span class="o">-</span><span class="mi">2023</span> <span class="n">Shaun</span> <span class="n">Purcell</span><span class="p">,</span> <span class="n">Christopher</span> <span class="n">Chang</span>   <span class="n">GNU</span> <span class="n">General</span> <span class="n">Public</span> <span class="n">License</span> <span class="n">v3</span>
<span class="n">Logging</span> <span class="n">to</span> <span class="n">SampleData1</span><span class="o">/</span><span class="n">Fold_0</span><span class="o">/</span><span class="n">train_data</span><span class="o">.</span><span class="n">QC</span><span class="o">.</span><span class="n">log</span><span class="o">.</span>
<span class="n">Options</span> <span class="ow">in</span> <span class="n">effect</span><span class="p">:</span>
  <span class="o">--</span><span class="n">bfile</span> <span class="n">SampleData1</span><span class="o">/</span><span class="n">Fold_0</span><span class="o">/</span><span class="n">train_data</span>
  <span class="o">--</span><span class="n">geno</span> <span class="mf">0.1</span>
  <span class="o">--</span><span class="n">hwe</span> <span class="mf">1e-6</span>
  <span class="o">--</span><span class="n">maf</span> <span class="mf">0.01</span>
  <span class="o">--</span><span class="n">make</span><span class="o">-</span><span class="n">just</span><span class="o">-</span><span class="n">fam</span>
  <span class="o">--</span><span class="n">mind</span> <span class="mf">0.1</span>
  <span class="o">--</span><span class="n">out</span> <span class="n">SampleData1</span><span class="o">/</span><span class="n">Fold_0</span><span class="o">/</span><span class="n">train_data</span><span class="o">.</span><span class="n">QC</span>
  <span class="o">--</span><span class="n">write</span><span class="o">-</span><span class="n">snplist</span>

<span class="mi">63761</span> <span class="n">MB</span> <span class="n">RAM</span> <span class="n">detected</span><span class="p">;</span> <span class="n">reserving</span> <span class="mi">31880</span> <span class="n">MB</span> <span class="k">for</span> <span class="n">main</span> <span class="n">workspace</span><span class="o">.</span>
<span class="mi">551892</span> <span class="n">variants</span> <span class="n">loaded</span> <span class="kn">from</span> <span class="nn">.bim</span> <span class="n">file</span><span class="o">.</span>
<span class="mi">380</span> <span class="n">people</span> <span class="p">(</span><span class="mi">183</span> <span class="n">males</span><span class="p">,</span> <span class="mi">197</span> <span class="n">females</span><span class="p">)</span> <span class="n">loaded</span> <span class="kn">from</span> <span class="nn">.fam.</span>
<span class="mi">380</span> <span class="n">phenotype</span> <span class="n">values</span> <span class="n">loaded</span> <span class="kn">from</span> <span class="nn">.fam.</span>
<span class="mi">0</span> <span class="n">people</span> <span class="n">removed</span> <span class="n">due</span> <span class="n">to</span> <span class="n">missing</span> <span class="n">genotype</span> <span class="n">data</span> <span class="p">(</span><span class="o">--</span><span class="n">mind</span><span class="p">)</span><span class="o">.</span>
<span class="n">Using</span> <span class="mi">1</span> <span class="n">thread</span> <span class="p">(</span><span class="n">no</span> <span class="n">multithreaded</span> <span class="n">calculations</span> <span class="n">invoked</span><span class="p">)</span><span class="o">.</span>
<span class="n">Before</span> <span class="n">main</span> <span class="n">variant</span> <span class="n">filters</span><span class="p">,</span> <span class="mi">380</span> <span class="n">founders</span> <span class="ow">and</span> <span class="mi">0</span> <span class="n">nonfounders</span> <span class="n">present</span><span class="o">.</span>
<span class="n">Calculating</span> <span class="n">allele</span> <span class="n">frequencies</span><span class="o">...</span> <span class="mi">10111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394959697989</span> <span class="n">done</span><span class="o">.</span>
<span class="n">Total</span> <span class="n">genotyping</span> <span class="n">rate</span> <span class="ow">is</span> <span class="mf">0.999896</span><span class="o">.</span>
<span class="mi">1</span> <span class="n">variant</span> <span class="n">removed</span> <span class="n">due</span> <span class="n">to</span> <span class="n">missing</span> <span class="n">genotype</span> <span class="n">data</span> <span class="p">(</span><span class="o">--</span><span class="n">geno</span><span class="p">)</span><span class="o">.</span>
<span class="o">--</span><span class="n">hwe</span><span class="p">:</span> <span class="mi">822</span> <span class="n">variants</span> <span class="n">removed</span> <span class="n">due</span> <span class="n">to</span> <span class="n">Hardy</span><span class="o">-</span><span class="n">Weinberg</span> <span class="n">exact</span> <span class="n">test</span><span class="o">.</span>
<span class="mi">8415</span> <span class="n">variants</span> <span class="n">removed</span> <span class="n">due</span> <span class="n">to</span> <span class="n">minor</span> <span class="n">allele</span> <span class="n">threshold</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="p">(</span><span class="o">--</span><span class="n">maf</span><span class="o">/--</span><span class="nb">max</span><span class="o">-</span><span class="n">maf</span><span class="o">/--</span><span class="n">mac</span><span class="o">/--</span><span class="nb">max</span><span class="o">-</span><span class="n">mac</span><span class="p">)</span><span class="o">.</span>
<span class="mi">542654</span> <span class="n">variants</span> <span class="ow">and</span> <span class="mi">380</span> <span class="n">people</span> <span class="k">pass</span> <span class="n">filters</span> <span class="ow">and</span> <span class="n">QC</span><span class="o">.</span>
<span class="n">Phenotype</span> <span class="n">data</span> <span class="ow">is</span> <span class="n">quantitative</span><span class="o">.</span>
<span class="n">List</span> <span class="n">of</span> <span class="n">variant</span> <span class="n">IDs</span> <span class="n">written</span> <span class="n">to</span> <span class="n">SampleData1</span><span class="o">/</span><span class="n">Fold_0</span><span class="o">/</span><span class="n">train_data</span><span class="o">.</span><span class="n">QC</span><span class="o">.</span><span class="n">snplist</span> <span class="o">.</span>
<span class="o">--</span><span class="n">make</span><span class="o">-</span><span class="n">just</span><span class="o">-</span><span class="n">fam</span> <span class="n">to</span> <span class="n">SampleData1</span><span class="o">/</span><span class="n">Fold_0</span><span class="o">/</span><span class="n">train_data</span><span class="o">.</span><span class="n">QC</span><span class="o">.</span><span class="n">fam</span> <span class="o">...</span> <span class="n">done</span><span class="o">.</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ne">Warning</span><span class="p">:</span> <span class="o">--</span><span class="n">hwe</span> <span class="n">observation</span> <span class="n">counts</span> <span class="n">vary</span> <span class="n">by</span> <span class="n">more</span> <span class="n">than</span> <span class="mi">10</span><span class="o">%</span><span class="p">,</span> <span class="n">due</span> <span class="n">to</span> <span class="n">the</span> <span class="n">X</span>
<span class="n">chromosome</span><span class="o">.</span>  <span class="n">You</span> <span class="n">may</span> <span class="n">want</span> <span class="n">to</span> <span class="n">use</span> <span class="n">a</span> <span class="n">less</span> <span class="n">stringent</span> <span class="o">--</span><span class="n">hwe</span> <span class="n">p</span><span class="o">-</span><span class="n">value</span> <span class="n">threshold</span> <span class="k">for</span> <span class="n">X</span>
<span class="n">chromosome</span> <span class="n">variants</span><span class="o">.</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">PLINK</span> <span class="n">v1</span><span class="mf">.90</span><span class="n">b7</span><span class="mf">.2</span> <span class="mi">64</span><span class="o">-</span><span class="n">bit</span> <span class="p">(</span><span class="mi">11</span> <span class="n">Dec</span> <span class="mi">2023</span><span class="p">)</span>           <span class="n">www</span><span class="o">.</span><span class="n">cog</span><span class="o">-</span><span class="n">genomics</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">plink</span><span class="o">/</span><span class="mf">1.9</span><span class="o">/</span>
<span class="p">(</span><span class="n">C</span><span class="p">)</span> <span class="mi">2005</span><span class="o">-</span><span class="mi">2023</span> <span class="n">Shaun</span> <span class="n">Purcell</span><span class="p">,</span> <span class="n">Christopher</span> <span class="n">Chang</span>   <span class="n">GNU</span> <span class="n">General</span> <span class="n">Public</span> <span class="n">License</span> <span class="n">v3</span>
<span class="n">Logging</span> <span class="n">to</span> <span class="n">SampleData1</span><span class="o">/</span><span class="n">Fold_0</span><span class="o">/</span><span class="n">train_data</span><span class="o">.</span><span class="n">QC</span><span class="o">.</span><span class="n">log</span><span class="o">.</span>
<span class="n">Options</span> <span class="ow">in</span> <span class="n">effect</span><span class="p">:</span>
  <span class="o">--</span><span class="n">bfile</span> <span class="n">SampleData1</span><span class="o">/</span><span class="n">Fold_0</span><span class="o">/</span><span class="n">train_data</span>
  <span class="o">--</span><span class="n">extract</span> <span class="n">SampleData1</span><span class="o">/</span><span class="n">Fold_0</span><span class="o">/</span><span class="n">train_data</span><span class="o">.</span><span class="n">QC</span><span class="o">.</span><span class="n">snplist</span>
  <span class="o">--</span><span class="n">het</span>
  <span class="o">--</span><span class="n">keep</span> <span class="n">SampleData1</span><span class="o">/</span><span class="n">Fold_0</span><span class="o">/</span><span class="n">train_data</span><span class="o">.</span><span class="n">QC</span><span class="o">.</span><span class="n">fam</span>
  <span class="o">--</span><span class="n">out</span> <span class="n">SampleData1</span><span class="o">/</span><span class="n">Fold_0</span><span class="o">/</span><span class="n">train_data</span><span class="o">.</span><span class="n">QC</span>

<span class="mi">63761</span> <span class="n">MB</span> <span class="n">RAM</span> <span class="n">detected</span><span class="p">;</span> <span class="n">reserving</span> <span class="mi">31880</span> <span class="n">MB</span> <span class="k">for</span> <span class="n">main</span> <span class="n">workspace</span><span class="o">.</span>
<span class="mi">551892</span> <span class="n">variants</span> <span class="n">loaded</span> <span class="kn">from</span> <span class="nn">.bim</span> <span class="n">file</span><span class="o">.</span>
<span class="mi">380</span> <span class="n">people</span> <span class="p">(</span><span class="mi">183</span> <span class="n">males</span><span class="p">,</span> <span class="mi">197</span> <span class="n">females</span><span class="p">)</span> <span class="n">loaded</span> <span class="kn">from</span> <span class="nn">.fam.</span>
<span class="mi">380</span> <span class="n">phenotype</span> <span class="n">values</span> <span class="n">loaded</span> <span class="kn">from</span> <span class="nn">.fam.</span>
<span class="o">--</span><span class="n">extract</span><span class="p">:</span> <span class="mi">542654</span> <span class="n">variants</span> <span class="n">remaining</span><span class="o">.</span>
<span class="o">--</span><span class="n">keep</span><span class="p">:</span> <span class="mi">380</span> <span class="n">people</span> <span class="n">remaining</span><span class="o">.</span>
<span class="n">Using</span> <span class="mi">1</span> <span class="n">thread</span> <span class="p">(</span><span class="n">no</span> <span class="n">multithreaded</span> <span class="n">calculations</span> <span class="n">invoked</span><span class="p">)</span><span class="o">.</span>
<span class="n">Before</span> <span class="n">main</span> <span class="n">variant</span> <span class="n">filters</span><span class="p">,</span> <span class="mi">380</span> <span class="n">founders</span> <span class="ow">and</span> <span class="mi">0</span> <span class="n">nonfounders</span> <span class="n">present</span><span class="o">.</span>
<span class="n">Calculating</span> <span class="n">allele</span> <span class="n">frequencies</span><span class="o">...</span> <span class="mi">10111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394959697989</span> <span class="n">done</span><span class="o">.</span>
<span class="n">Total</span> <span class="n">genotyping</span> <span class="n">rate</span> <span class="ow">is</span> <span class="mf">0.999898</span><span class="o">.</span>
<span class="mi">542654</span> <span class="n">variants</span> <span class="ow">and</span> <span class="mi">380</span> <span class="n">people</span> <span class="k">pass</span> <span class="n">filters</span> <span class="ow">and</span> <span class="n">QC</span><span class="o">.</span>
<span class="n">Phenotype</span> <span class="n">data</span> <span class="ow">is</span> <span class="n">quantitative</span><span class="o">.</span>
<span class="o">--</span><span class="n">het</span><span class="p">:</span> <span class="mi">521371</span> <span class="n">variants</span> <span class="n">scanned</span><span class="p">,</span> <span class="n">report</span> <span class="n">written</span> <span class="n">to</span>
<span class="n">SampleData1</span><span class="o">/</span><span class="n">Fold_0</span><span class="o">/</span><span class="n">train_data</span><span class="o">.</span><span class="n">QC</span><span class="o">.</span><span class="n">het</span> <span class="o">.</span>
<span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="s2">&quot;SampleData1/Fold_0&quot;</span> <span class="s2">&quot;train_data&quot;</span>         <span class="s2">&quot;train_data.QC&quot;</span>
<span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="s2">&quot;1&quot;</span>
<span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="s2">&quot;SampleData1&quot;</span> <span class="s2">&quot;Fold_0&quot;</span>
<span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="s2">&quot;SampleData1&quot;</span>
<span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="mi">14</span>
<span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="mi">14</span>
<span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="mi">14</span>
<span class="n">Rscript</span> <span class="n">Module1</span><span class="o">.</span><span class="n">R</span> <span class="n">SampleData1</span><span class="o">/</span><span class="n">Fold_0</span>  <span class="n">train_data</span> <span class="n">train_data</span><span class="o">.</span><span class="n">QC</span> <span class="mi">1</span>
<span class="n">PLINK</span> <span class="n">v1</span><span class="mf">.90</span><span class="n">b7</span><span class="mf">.2</span> <span class="mi">64</span><span class="o">-</span><span class="n">bit</span> <span class="p">(</span><span class="mi">11</span> <span class="n">Dec</span> <span class="mi">2023</span><span class="p">)</span>           <span class="n">www</span><span class="o">.</span><span class="n">cog</span><span class="o">-</span><span class="n">genomics</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">plink</span><span class="o">/</span><span class="mf">1.9</span><span class="o">/</span>
<span class="p">(</span><span class="n">C</span><span class="p">)</span> <span class="mi">2005</span><span class="o">-</span><span class="mi">2023</span> <span class="n">Shaun</span> <span class="n">Purcell</span><span class="p">,</span> <span class="n">Christopher</span> <span class="n">Chang</span>   <span class="n">GNU</span> <span class="n">General</span> <span class="n">Public</span> <span class="n">License</span> <span class="n">v3</span>
<span class="n">Logging</span> <span class="n">to</span> <span class="n">SampleData1</span><span class="o">/</span><span class="n">Fold_0</span><span class="o">/</span><span class="n">train_data</span><span class="o">.</span><span class="n">QC</span><span class="o">.</span><span class="n">log</span><span class="o">.</span>
<span class="n">Options</span> <span class="ow">in</span> <span class="n">effect</span><span class="p">:</span>
  <span class="o">--</span><span class="n">bfile</span> <span class="n">SampleData1</span><span class="o">/</span><span class="n">Fold_0</span><span class="o">/</span><span class="n">train_data</span>
  <span class="o">--</span><span class="n">extract</span> <span class="n">SampleData1</span><span class="o">/</span><span class="n">Fold_0</span><span class="o">/</span><span class="n">train_data</span><span class="o">.</span><span class="n">QC</span><span class="o">.</span><span class="n">snplist</span>
  <span class="o">--</span><span class="n">out</span> <span class="n">SampleData1</span><span class="o">/</span><span class="n">Fold_0</span><span class="o">/</span><span class="n">train_data</span><span class="o">.</span><span class="n">QC</span>
  <span class="o">--</span><span class="n">rel</span><span class="o">-</span><span class="n">cutoff</span> <span class="mf">0.125</span>

<span class="mi">63761</span> <span class="n">MB</span> <span class="n">RAM</span> <span class="n">detected</span><span class="p">;</span> <span class="n">reserving</span> <span class="mi">31880</span> <span class="n">MB</span> <span class="k">for</span> <span class="n">main</span> <span class="n">workspace</span><span class="o">.</span>
<span class="mi">551892</span> <span class="n">variants</span> <span class="n">loaded</span> <span class="kn">from</span> <span class="nn">.bim</span> <span class="n">file</span><span class="o">.</span>
<span class="mi">380</span> <span class="n">people</span> <span class="p">(</span><span class="mi">183</span> <span class="n">males</span><span class="p">,</span> <span class="mi">197</span> <span class="n">females</span><span class="p">)</span> <span class="n">loaded</span> <span class="kn">from</span> <span class="nn">.fam.</span>
<span class="mi">380</span> <span class="n">phenotype</span> <span class="n">values</span> <span class="n">loaded</span> <span class="kn">from</span> <span class="nn">.fam.</span>
<span class="o">--</span><span class="n">extract</span><span class="p">:</span> <span class="mi">542654</span> <span class="n">variants</span> <span class="n">remaining</span><span class="o">.</span>
<span class="n">Using</span> <span class="n">up</span> <span class="n">to</span> <span class="mi">8</span> <span class="n">threads</span> <span class="p">(</span><span class="n">change</span> <span class="n">this</span> <span class="k">with</span> <span class="o">--</span><span class="n">threads</span><span class="p">)</span><span class="o">.</span>
<span class="n">Before</span> <span class="n">main</span> <span class="n">variant</span> <span class="n">filters</span><span class="p">,</span> <span class="mi">380</span> <span class="n">founders</span> <span class="ow">and</span> <span class="mi">0</span> <span class="n">nonfounders</span> <span class="n">present</span><span class="o">.</span>
<span class="n">Calculating</span> <span class="n">allele</span> <span class="n">frequencies</span><span class="o">...</span> <span class="mi">10111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394959697989</span> <span class="n">done</span><span class="o">.</span>
<span class="n">Total</span> <span class="n">genotyping</span> <span class="n">rate</span> <span class="ow">is</span> <span class="mf">0.999898</span><span class="o">.</span>
<span class="mi">542654</span> <span class="n">variants</span> <span class="ow">and</span> <span class="mi">380</span> <span class="n">people</span> <span class="k">pass</span> <span class="n">filters</span> <span class="ow">and</span> <span class="n">QC</span> <span class="p">(</span><span class="n">before</span> <span class="o">--</span><span class="n">rel</span><span class="o">-</span><span class="n">cutoff</span><span class="p">)</span><span class="o">.</span>
<span class="n">Phenotype</span> <span class="n">data</span> <span class="ow">is</span> <span class="n">quantitative</span><span class="o">.</span>
<span class="n">Excluding</span> <span class="mi">21283</span> <span class="n">variants</span> <span class="n">on</span> <span class="n">non</span><span class="o">-</span><span class="n">autosomes</span> <span class="kn">from</span> <span class="nn">relationship</span> <span class="n">matrix</span> <span class="n">calc</span><span class="o">.</span>
<span class="n">Relationship</span> <span class="n">matrix</span> <span class="n">calculation</span> <span class="n">complete</span><span class="o">.</span>
<span class="mi">0</span> <span class="n">people</span> <span class="n">excluded</span> <span class="n">by</span> <span class="o">--</span><span class="n">rel</span><span class="o">-</span><span class="n">cutoff</span><span class="o">.</span>
<span class="n">Remaining</span> <span class="n">sample</span> <span class="n">IDs</span> <span class="n">written</span> <span class="n">to</span> <span class="n">SampleData1</span><span class="o">/</span><span class="n">Fold_0</span><span class="o">/</span><span class="n">train_data</span><span class="o">.</span><span class="n">QC</span><span class="o">.</span><span class="n">rel</span><span class="o">.</span><span class="n">id</span> <span class="o">.</span>
<span class="n">PLINK</span> <span class="n">v1</span><span class="mf">.90</span><span class="n">b7</span><span class="mf">.2</span> <span class="mi">64</span><span class="o">-</span><span class="n">bit</span> <span class="p">(</span><span class="mi">11</span> <span class="n">Dec</span> <span class="mi">2023</span><span class="p">)</span>           <span class="n">www</span><span class="o">.</span><span class="n">cog</span><span class="o">-</span><span class="n">genomics</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">plink</span><span class="o">/</span><span class="mf">1.9</span><span class="o">/</span>
<span class="p">(</span><span class="n">C</span><span class="p">)</span> <span class="mi">2005</span><span class="o">-</span><span class="mi">2023</span> <span class="n">Shaun</span> <span class="n">Purcell</span><span class="p">,</span> <span class="n">Christopher</span> <span class="n">Chang</span>   <span class="n">GNU</span> <span class="n">General</span> <span class="n">Public</span> <span class="n">License</span> <span class="n">v3</span>
<span class="n">Logging</span> <span class="n">to</span> <span class="n">SampleData1</span><span class="o">/</span><span class="n">Fold_0</span><span class="o">/</span><span class="n">train_data</span><span class="o">.</span><span class="n">QC</span><span class="o">.</span><span class="n">log</span><span class="o">.</span>
<span class="n">Options</span> <span class="ow">in</span> <span class="n">effect</span><span class="p">:</span>
  <span class="o">--</span><span class="n">a1</span><span class="o">-</span><span class="n">allele</span> <span class="n">SampleData1</span><span class="o">/</span><span class="n">Fold_0</span><span class="o">/</span><span class="n">train_data</span><span class="o">.</span><span class="n">a1</span>
  <span class="o">--</span><span class="n">bfile</span> <span class="n">SampleData1</span><span class="o">/</span><span class="n">Fold_0</span><span class="o">/</span><span class="n">train_data</span>
  <span class="o">--</span><span class="n">exclude</span> <span class="n">SampleData1</span><span class="o">/</span><span class="n">Fold_0</span><span class="o">/</span><span class="n">train_data</span><span class="o">.</span><span class="n">mismatch</span>
  <span class="o">--</span><span class="n">extract</span> <span class="n">SampleData1</span><span class="o">/</span><span class="n">Fold_0</span><span class="o">/</span><span class="n">train_data</span><span class="o">.</span><span class="n">QC</span><span class="o">.</span><span class="n">snplist</span>
  <span class="o">--</span><span class="n">keep</span> <span class="n">SampleData1</span><span class="o">/</span><span class="n">Fold_0</span><span class="o">/</span><span class="n">train_data</span><span class="o">.</span><span class="n">QC</span><span class="o">.</span><span class="n">rel</span><span class="o">.</span><span class="n">id</span>
  <span class="o">--</span><span class="n">make</span><span class="o">-</span><span class="n">bed</span>
  <span class="o">--</span><span class="n">out</span> <span class="n">SampleData1</span><span class="o">/</span><span class="n">Fold_0</span><span class="o">/</span><span class="n">train_data</span><span class="o">.</span><span class="n">QC</span>

<span class="mi">63761</span> <span class="n">MB</span> <span class="n">RAM</span> <span class="n">detected</span><span class="p">;</span> <span class="n">reserving</span> <span class="mi">31880</span> <span class="n">MB</span> <span class="k">for</span> <span class="n">main</span> <span class="n">workspace</span><span class="o">.</span>
<span class="mi">551892</span> <span class="n">variants</span> <span class="n">loaded</span> <span class="kn">from</span> <span class="nn">.bim</span> <span class="n">file</span><span class="o">.</span>
<span class="mi">380</span> <span class="n">people</span> <span class="p">(</span><span class="mi">183</span> <span class="n">males</span><span class="p">,</span> <span class="mi">197</span> <span class="n">females</span><span class="p">)</span> <span class="n">loaded</span> <span class="kn">from</span> <span class="nn">.fam.</span>
<span class="mi">380</span> <span class="n">phenotype</span> <span class="n">values</span> <span class="n">loaded</span> <span class="kn">from</span> <span class="nn">.fam.</span>
<span class="o">--</span><span class="n">extract</span><span class="p">:</span> <span class="mi">542654</span> <span class="n">variants</span> <span class="n">remaining</span><span class="o">.</span>
<span class="o">--</span><span class="n">exclude</span><span class="p">:</span> <span class="mi">491952</span> <span class="n">variants</span> <span class="n">remaining</span><span class="o">.</span>
<span class="o">--</span><span class="n">keep</span><span class="p">:</span> <span class="mi">380</span> <span class="n">people</span> <span class="n">remaining</span><span class="o">.</span>
<span class="n">Using</span> <span class="mi">1</span> <span class="n">thread</span> <span class="p">(</span><span class="n">no</span> <span class="n">multithreaded</span> <span class="n">calculations</span> <span class="n">invoked</span><span class="p">)</span><span class="o">.</span>
<span class="n">Before</span> <span class="n">main</span> <span class="n">variant</span> <span class="n">filters</span><span class="p">,</span> <span class="mi">380</span> <span class="n">founders</span> <span class="ow">and</span> <span class="mi">0</span> <span class="n">nonfounders</span> <span class="n">present</span><span class="o">.</span>
<span class="n">Calculating</span> <span class="n">allele</span> <span class="n">frequencies</span><span class="o">...</span> <span class="mi">10111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394959697989</span> <span class="n">done</span><span class="o">.</span>
<span class="n">Total</span> <span class="n">genotyping</span> <span class="n">rate</span> <span class="ow">is</span> <span class="mf">0.999894</span><span class="o">.</span>
<span class="o">--</span><span class="n">a1</span><span class="o">-</span><span class="n">allele</span><span class="p">:</span> <span class="mi">491952</span> <span class="n">assignments</span> <span class="n">made</span><span class="o">.</span>
<span class="mi">491952</span> <span class="n">variants</span> <span class="ow">and</span> <span class="mi">380</span> <span class="n">people</span> <span class="k">pass</span> <span class="n">filters</span> <span class="ow">and</span> <span class="n">QC</span><span class="o">.</span>
<span class="n">Phenotype</span> <span class="n">data</span> <span class="ow">is</span> <span class="n">quantitative</span><span class="o">.</span>
<span class="o">--</span><span class="n">make</span><span class="o">-</span><span class="n">bed</span> <span class="n">to</span> <span class="n">SampleData1</span><span class="o">/</span><span class="n">Fold_0</span><span class="o">/</span><span class="n">train_data</span><span class="o">.</span><span class="n">QC</span><span class="o">.</span><span class="n">bed</span> <span class="o">+</span>
<span class="n">SampleData1</span><span class="o">/</span><span class="n">Fold_0</span><span class="o">/</span><span class="n">train_data</span><span class="o">.</span><span class="n">QC</span><span class="o">.</span><span class="n">bim</span> <span class="o">+</span> <span class="n">SampleData1</span><span class="o">/</span><span class="n">Fold_0</span><span class="o">/</span><span class="n">train_data</span><span class="o">.</span><span class="n">QC</span><span class="o">.</span><span class="n">fam</span> <span class="o">...</span>
<span class="mi">101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899</span><span class="n">done</span><span class="o">.</span>
<span class="n">PLINK</span> <span class="n">v1</span><span class="mf">.90</span><span class="n">b7</span><span class="mf">.2</span> <span class="mi">64</span><span class="o">-</span><span class="n">bit</span> <span class="p">(</span><span class="mi">11</span> <span class="n">Dec</span> <span class="mi">2023</span><span class="p">)</span>           <span class="n">www</span><span class="o">.</span><span class="n">cog</span><span class="o">-</span><span class="n">genomics</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">plink</span><span class="o">/</span><span class="mf">1.9</span><span class="o">/</span>
<span class="p">(</span><span class="n">C</span><span class="p">)</span> <span class="mi">2005</span><span class="o">-</span><span class="mi">2023</span> <span class="n">Shaun</span> <span class="n">Purcell</span><span class="p">,</span> <span class="n">Christopher</span> <span class="n">Chang</span>   <span class="n">GNU</span> <span class="n">General</span> <span class="n">Public</span> <span class="n">License</span> <span class="n">v3</span>
<span class="n">Logging</span> <span class="n">to</span> <span class="n">SampleData1</span><span class="o">/</span><span class="n">Fold_1</span><span class="o">/</span><span class="n">train_data</span><span class="o">.</span><span class="n">log</span><span class="o">.</span>
<span class="n">Options</span> <span class="ow">in</span> <span class="n">effect</span><span class="p">:</span>
  <span class="o">--</span><span class="n">bfile</span> <span class="n">SampleData1</span><span class="o">/</span><span class="n">SampleData1_QC</span>
  <span class="o">--</span><span class="n">keep</span> <span class="n">SampleData1</span><span class="o">/</span><span class="n">Fold_1</span><span class="o">/</span><span class="n">train_data</span><span class="o">.</span><span class="n">fam</span>
  <span class="o">--</span><span class="n">make</span><span class="o">-</span><span class="n">bed</span>
  <span class="o">--</span><span class="n">out</span> <span class="n">SampleData1</span><span class="o">/</span><span class="n">Fold_1</span><span class="o">/</span><span class="n">train_data</span>

<span class="mi">63761</span> <span class="n">MB</span> <span class="n">RAM</span> <span class="n">detected</span><span class="p">;</span> <span class="n">reserving</span> <span class="mi">31880</span> <span class="n">MB</span> <span class="k">for</span> <span class="n">main</span> <span class="n">workspace</span><span class="o">.</span>
<span class="mi">551892</span> <span class="n">variants</span> <span class="n">loaded</span> <span class="kn">from</span> <span class="nn">.bim</span> <span class="n">file</span><span class="o">.</span>
<span class="mi">475</span> <span class="n">people</span> <span class="p">(</span><span class="mi">227</span> <span class="n">males</span><span class="p">,</span> <span class="mi">248</span> <span class="n">females</span><span class="p">)</span> <span class="n">loaded</span> <span class="kn">from</span> <span class="nn">.fam.</span>
<span class="mi">475</span> <span class="n">phenotype</span> <span class="n">values</span> <span class="n">loaded</span> <span class="kn">from</span> <span class="nn">.fam.</span>
<span class="o">--</span><span class="n">keep</span><span class="p">:</span> <span class="mi">380</span> <span class="n">people</span> <span class="n">remaining</span><span class="o">.</span>
<span class="n">Using</span> <span class="mi">1</span> <span class="n">thread</span> <span class="p">(</span><span class="n">no</span> <span class="n">multithreaded</span> <span class="n">calculations</span> <span class="n">invoked</span><span class="p">)</span><span class="o">.</span>
<span class="n">Before</span> <span class="n">main</span> <span class="n">variant</span> <span class="n">filters</span><span class="p">,</span> <span class="mi">380</span> <span class="n">founders</span> <span class="ow">and</span> <span class="mi">0</span> <span class="n">nonfounders</span> <span class="n">present</span><span class="o">.</span>
<span class="n">Calculating</span> <span class="n">allele</span> <span class="n">frequencies</span><span class="o">...</span> <span class="mi">10111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394959697989</span> <span class="n">done</span><span class="o">.</span>
<span class="n">Total</span> <span class="n">genotyping</span> <span class="n">rate</span> <span class="ow">in</span> <span class="n">remaining</span> <span class="n">samples</span> <span class="ow">is</span> <span class="mf">0.999922</span><span class="o">.</span>
<span class="mi">551892</span> <span class="n">variants</span> <span class="ow">and</span> <span class="mi">380</span> <span class="n">people</span> <span class="k">pass</span> <span class="n">filters</span> <span class="ow">and</span> <span class="n">QC</span><span class="o">.</span>
<span class="n">Phenotype</span> <span class="n">data</span> <span class="ow">is</span> <span class="n">quantitative</span><span class="o">.</span>
<span class="o">--</span><span class="n">make</span><span class="o">-</span><span class="n">bed</span> <span class="n">to</span> <span class="n">SampleData1</span><span class="o">/</span><span class="n">Fold_1</span><span class="o">/</span><span class="n">train_data</span><span class="o">.</span><span class="n">bed</span> <span class="o">+</span>
<span class="n">SampleData1</span><span class="o">/</span><span class="n">Fold_1</span><span class="o">/</span><span class="n">train_data</span><span class="o">.</span><span class="n">bim</span> <span class="o">+</span> <span class="n">SampleData1</span><span class="o">/</span><span class="n">Fold_1</span><span class="o">/</span><span class="n">train_data</span><span class="o">.</span><span class="n">fam</span> <span class="o">...</span> <span class="mi">101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899</span><span class="n">done</span><span class="o">.</span>
<span class="n">PLINK</span> <span class="n">v1</span><span class="mf">.90</span><span class="n">b7</span><span class="mf">.2</span> <span class="mi">64</span><span class="o">-</span><span class="n">bit</span> <span class="p">(</span><span class="mi">11</span> <span class="n">Dec</span> <span class="mi">2023</span><span class="p">)</span>           <span class="n">www</span><span class="o">.</span><span class="n">cog</span><span class="o">-</span><span class="n">genomics</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">plink</span><span class="o">/</span><span class="mf">1.9</span><span class="o">/</span>
<span class="p">(</span><span class="n">C</span><span class="p">)</span> <span class="mi">2005</span><span class="o">-</span><span class="mi">2023</span> <span class="n">Shaun</span> <span class="n">Purcell</span><span class="p">,</span> <span class="n">Christopher</span> <span class="n">Chang</span>   <span class="n">GNU</span> <span class="n">General</span> <span class="n">Public</span> <span class="n">License</span> <span class="n">v3</span>
<span class="n">Logging</span> <span class="n">to</span> <span class="n">SampleData1</span><span class="o">/</span><span class="n">Fold_1</span><span class="o">/</span><span class="n">test_data</span><span class="o">.</span><span class="n">log</span><span class="o">.</span>
<span class="n">Options</span> <span class="ow">in</span> <span class="n">effect</span><span class="p">:</span>
  <span class="o">--</span><span class="n">bfile</span> <span class="n">SampleData1</span><span class="o">/</span><span class="n">SampleData1_QC</span>
  <span class="o">--</span><span class="n">keep</span> <span class="n">SampleData1</span><span class="o">/</span><span class="n">Fold_1</span><span class="o">/</span><span class="n">test_data</span><span class="o">.</span><span class="n">fam</span>
  <span class="o">--</span><span class="n">make</span><span class="o">-</span><span class="n">bed</span>
  <span class="o">--</span><span class="n">out</span> <span class="n">SampleData1</span><span class="o">/</span><span class="n">Fold_1</span><span class="o">/</span><span class="n">test_data</span>

<span class="mi">63761</span> <span class="n">MB</span> <span class="n">RAM</span> <span class="n">detected</span><span class="p">;</span> <span class="n">reserving</span> <span class="mi">31880</span> <span class="n">MB</span> <span class="k">for</span> <span class="n">main</span> <span class="n">workspace</span><span class="o">.</span>
<span class="mi">551892</span> <span class="n">variants</span> <span class="n">loaded</span> <span class="kn">from</span> <span class="nn">.bim</span> <span class="n">file</span><span class="o">.</span>
<span class="mi">475</span> <span class="n">people</span> <span class="p">(</span><span class="mi">227</span> <span class="n">males</span><span class="p">,</span> <span class="mi">248</span> <span class="n">females</span><span class="p">)</span> <span class="n">loaded</span> <span class="kn">from</span> <span class="nn">.fam.</span>
<span class="mi">475</span> <span class="n">phenotype</span> <span class="n">values</span> <span class="n">loaded</span> <span class="kn">from</span> <span class="nn">.fam.</span>
<span class="o">--</span><span class="n">keep</span><span class="p">:</span> <span class="mi">95</span> <span class="n">people</span> <span class="n">remaining</span><span class="o">.</span>
<span class="n">Using</span> <span class="mi">1</span> <span class="n">thread</span> <span class="p">(</span><span class="n">no</span> <span class="n">multithreaded</span> <span class="n">calculations</span> <span class="n">invoked</span><span class="p">)</span><span class="o">.</span>
<span class="n">Before</span> <span class="n">main</span> <span class="n">variant</span> <span class="n">filters</span><span class="p">,</span> <span class="mi">95</span> <span class="n">founders</span> <span class="ow">and</span> <span class="mi">0</span> <span class="n">nonfounders</span> <span class="n">present</span><span class="o">.</span>
<span class="n">Calculating</span> <span class="n">allele</span> <span class="n">frequencies</span><span class="o">...</span> <span class="mi">10111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394959697989</span> <span class="n">done</span><span class="o">.</span>
<span class="n">Total</span> <span class="n">genotyping</span> <span class="n">rate</span> <span class="ow">in</span> <span class="n">remaining</span> <span class="n">samples</span> <span class="ow">is</span> <span class="mf">0.999794</span><span class="o">.</span>
<span class="mi">551892</span> <span class="n">variants</span> <span class="ow">and</span> <span class="mi">95</span> <span class="n">people</span> <span class="k">pass</span> <span class="n">filters</span> <span class="ow">and</span> <span class="n">QC</span><span class="o">.</span>
<span class="n">Phenotype</span> <span class="n">data</span> <span class="ow">is</span> <span class="n">quantitative</span><span class="o">.</span>
<span class="o">--</span><span class="n">make</span><span class="o">-</span><span class="n">bed</span> <span class="n">to</span> <span class="n">SampleData1</span><span class="o">/</span><span class="n">Fold_1</span><span class="o">/</span><span class="n">test_data</span><span class="o">.</span><span class="n">bed</span> <span class="o">+</span>
<span class="n">SampleData1</span><span class="o">/</span><span class="n">Fold_1</span><span class="o">/</span><span class="n">test_data</span><span class="o">.</span><span class="n">bim</span> <span class="o">+</span> <span class="n">SampleData1</span><span class="o">/</span><span class="n">Fold_1</span><span class="o">/</span><span class="n">test_data</span><span class="o">.</span><span class="n">fam</span> <span class="o">...</span> <span class="mi">101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899</span><span class="n">done</span><span class="o">.</span>
<span class="n">PLINK</span> <span class="n">v1</span><span class="mf">.90</span><span class="n">b7</span><span class="mf">.2</span> <span class="mi">64</span><span class="o">-</span><span class="n">bit</span> <span class="p">(</span><span class="mi">11</span> <span class="n">Dec</span> <span class="mi">2023</span><span class="p">)</span>           <span class="n">www</span><span class="o">.</span><span class="n">cog</span><span class="o">-</span><span class="n">genomics</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">plink</span><span class="o">/</span><span class="mf">1.9</span><span class="o">/</span>
<span class="p">(</span><span class="n">C</span><span class="p">)</span> <span class="mi">2005</span><span class="o">-</span><span class="mi">2023</span> <span class="n">Shaun</span> <span class="n">Purcell</span><span class="p">,</span> <span class="n">Christopher</span> <span class="n">Chang</span>   <span class="n">GNU</span> <span class="n">General</span> <span class="n">Public</span> <span class="n">License</span> <span class="n">v3</span>
<span class="n">Logging</span> <span class="n">to</span> <span class="n">SampleData1</span><span class="o">/</span><span class="n">Fold_1</span><span class="o">/</span><span class="n">train_data</span><span class="o">.</span><span class="n">QC</span><span class="o">.</span><span class="n">log</span><span class="o">.</span>
<span class="n">Options</span> <span class="ow">in</span> <span class="n">effect</span><span class="p">:</span>
  <span class="o">--</span><span class="n">bfile</span> <span class="n">SampleData1</span><span class="o">/</span><span class="n">Fold_1</span><span class="o">/</span><span class="n">train_data</span>
  <span class="o">--</span><span class="n">geno</span> <span class="mf">0.1</span>
  <span class="o">--</span><span class="n">hwe</span> <span class="mf">1e-6</span>
  <span class="o">--</span><span class="n">maf</span> <span class="mf">0.01</span>
  <span class="o">--</span><span class="n">make</span><span class="o">-</span><span class="n">just</span><span class="o">-</span><span class="n">fam</span>
  <span class="o">--</span><span class="n">mind</span> <span class="mf">0.1</span>
  <span class="o">--</span><span class="n">out</span> <span class="n">SampleData1</span><span class="o">/</span><span class="n">Fold_1</span><span class="o">/</span><span class="n">train_data</span><span class="o">.</span><span class="n">QC</span>
  <span class="o">--</span><span class="n">write</span><span class="o">-</span><span class="n">snplist</span>

<span class="mi">63761</span> <span class="n">MB</span> <span class="n">RAM</span> <span class="n">detected</span><span class="p">;</span> <span class="n">reserving</span> <span class="mi">31880</span> <span class="n">MB</span> <span class="k">for</span> <span class="n">main</span> <span class="n">workspace</span><span class="o">.</span>
<span class="mi">551892</span> <span class="n">variants</span> <span class="n">loaded</span> <span class="kn">from</span> <span class="nn">.bim</span> <span class="n">file</span><span class="o">.</span>
<span class="mi">380</span> <span class="n">people</span> <span class="p">(</span><span class="mi">178</span> <span class="n">males</span><span class="p">,</span> <span class="mi">202</span> <span class="n">females</span><span class="p">)</span> <span class="n">loaded</span> <span class="kn">from</span> <span class="nn">.fam.</span>
<span class="mi">380</span> <span class="n">phenotype</span> <span class="n">values</span> <span class="n">loaded</span> <span class="kn">from</span> <span class="nn">.fam.</span>
<span class="mi">0</span> <span class="n">people</span> <span class="n">removed</span> <span class="n">due</span> <span class="n">to</span> <span class="n">missing</span> <span class="n">genotype</span> <span class="n">data</span> <span class="p">(</span><span class="o">--</span><span class="n">mind</span><span class="p">)</span><span class="o">.</span>
<span class="n">Using</span> <span class="mi">1</span> <span class="n">thread</span> <span class="p">(</span><span class="n">no</span> <span class="n">multithreaded</span> <span class="n">calculations</span> <span class="n">invoked</span><span class="p">)</span><span class="o">.</span>
<span class="n">Before</span> <span class="n">main</span> <span class="n">variant</span> <span class="n">filters</span><span class="p">,</span> <span class="mi">380</span> <span class="n">founders</span> <span class="ow">and</span> <span class="mi">0</span> <span class="n">nonfounders</span> <span class="n">present</span><span class="o">.</span>
<span class="n">Calculating</span> <span class="n">allele</span> <span class="n">frequencies</span><span class="o">...</span> <span class="mi">10111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394959697989</span> <span class="n">done</span><span class="o">.</span>
<span class="n">Total</span> <span class="n">genotyping</span> <span class="n">rate</span> <span class="ow">is</span> <span class="mf">0.999922</span><span class="o">.</span>
<span class="mi">1</span> <span class="n">variant</span> <span class="n">removed</span> <span class="n">due</span> <span class="n">to</span> <span class="n">missing</span> <span class="n">genotype</span> <span class="n">data</span> <span class="p">(</span><span class="o">--</span><span class="n">geno</span><span class="p">)</span><span class="o">.</span>
<span class="o">--</span><span class="n">hwe</span><span class="p">:</span> <span class="mi">855</span> <span class="n">variants</span> <span class="n">removed</span> <span class="n">due</span> <span class="n">to</span> <span class="n">Hardy</span><span class="o">-</span><span class="n">Weinberg</span> <span class="n">exact</span> <span class="n">test</span><span class="o">.</span>
<span class="mi">7923</span> <span class="n">variants</span> <span class="n">removed</span> <span class="n">due</span> <span class="n">to</span> <span class="n">minor</span> <span class="n">allele</span> <span class="n">threshold</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="p">(</span><span class="o">--</span><span class="n">maf</span><span class="o">/--</span><span class="nb">max</span><span class="o">-</span><span class="n">maf</span><span class="o">/--</span><span class="n">mac</span><span class="o">/--</span><span class="nb">max</span><span class="o">-</span><span class="n">mac</span><span class="p">)</span><span class="o">.</span>
<span class="mi">543113</span> <span class="n">variants</span> <span class="ow">and</span> <span class="mi">380</span> <span class="n">people</span> <span class="k">pass</span> <span class="n">filters</span> <span class="ow">and</span> <span class="n">QC</span><span class="o">.</span>
<span class="n">Phenotype</span> <span class="n">data</span> <span class="ow">is</span> <span class="n">quantitative</span><span class="o">.</span>
<span class="n">List</span> <span class="n">of</span> <span class="n">variant</span> <span class="n">IDs</span> <span class="n">written</span> <span class="n">to</span> <span class="n">SampleData1</span><span class="o">/</span><span class="n">Fold_1</span><span class="o">/</span><span class="n">train_data</span><span class="o">.</span><span class="n">QC</span><span class="o">.</span><span class="n">snplist</span> <span class="o">.</span>
<span class="o">--</span><span class="n">make</span><span class="o">-</span><span class="n">just</span><span class="o">-</span><span class="n">fam</span> <span class="n">to</span> <span class="n">SampleData1</span><span class="o">/</span><span class="n">Fold_1</span><span class="o">/</span><span class="n">train_data</span><span class="o">.</span><span class="n">QC</span><span class="o">.</span><span class="n">fam</span> <span class="o">...</span> <span class="n">done</span><span class="o">.</span>
<span class="n">PLINK</span> <span class="n">v1</span><span class="mf">.90</span><span class="n">b7</span><span class="mf">.2</span> <span class="mi">64</span><span class="o">-</span><span class="n">bit</span> <span class="p">(</span><span class="mi">11</span> <span class="n">Dec</span> <span class="mi">2023</span><span class="p">)</span>           <span class="n">www</span><span class="o">.</span><span class="n">cog</span><span class="o">-</span><span class="n">genomics</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">plink</span><span class="o">/</span><span class="mf">1.9</span><span class="o">/</span>
<span class="p">(</span><span class="n">C</span><span class="p">)</span> <span class="mi">2005</span><span class="o">-</span><span class="mi">2023</span> <span class="n">Shaun</span> <span class="n">Purcell</span><span class="p">,</span> <span class="n">Christopher</span> <span class="n">Chang</span>   <span class="n">GNU</span> <span class="n">General</span> <span class="n">Public</span> <span class="n">License</span> <span class="n">v3</span>
<span class="n">Logging</span> <span class="n">to</span> <span class="n">SampleData1</span><span class="o">/</span><span class="n">Fold_1</span><span class="o">/</span><span class="n">train_data</span><span class="o">.</span><span class="n">QC</span><span class="o">.</span><span class="n">log</span><span class="o">.</span>
<span class="n">Options</span> <span class="ow">in</span> <span class="n">effect</span><span class="p">:</span>
  <span class="o">--</span><span class="n">bfile</span> <span class="n">SampleData1</span><span class="o">/</span><span class="n">Fold_1</span><span class="o">/</span><span class="n">train_data</span>
  <span class="o">--</span><span class="n">extract</span> <span class="n">SampleData1</span><span class="o">/</span><span class="n">Fold_1</span><span class="o">/</span><span class="n">train_data</span><span class="o">.</span><span class="n">QC</span><span class="o">.</span><span class="n">snplist</span>
  <span class="o">--</span><span class="n">het</span>
  <span class="o">--</span><span class="n">keep</span> <span class="n">SampleData1</span><span class="o">/</span><span class="n">Fold_1</span><span class="o">/</span><span class="n">train_data</span><span class="o">.</span><span class="n">QC</span><span class="o">.</span><span class="n">fam</span>
  <span class="o">--</span><span class="n">out</span> <span class="n">SampleData1</span><span class="o">/</span><span class="n">Fold_1</span><span class="o">/</span><span class="n">train_data</span><span class="o">.</span><span class="n">QC</span>

<span class="mi">63761</span> <span class="n">MB</span> <span class="n">RAM</span> <span class="n">detected</span><span class="p">;</span> <span class="n">reserving</span> <span class="mi">31880</span> <span class="n">MB</span> <span class="k">for</span> <span class="n">main</span> <span class="n">workspace</span><span class="o">.</span>
<span class="mi">551892</span> <span class="n">variants</span> <span class="n">loaded</span> <span class="kn">from</span> <span class="nn">.bim</span> <span class="n">file</span><span class="o">.</span>
<span class="mi">380</span> <span class="n">people</span> <span class="p">(</span><span class="mi">178</span> <span class="n">males</span><span class="p">,</span> <span class="mi">202</span> <span class="n">females</span><span class="p">)</span> <span class="n">loaded</span> <span class="kn">from</span> <span class="nn">.fam.</span>
<span class="mi">380</span> <span class="n">phenotype</span> <span class="n">values</span> <span class="n">loaded</span> <span class="kn">from</span> <span class="nn">.fam.</span>
<span class="o">--</span><span class="n">extract</span><span class="p">:</span> <span class="mi">543113</span> <span class="n">variants</span> <span class="n">remaining</span><span class="o">.</span>
<span class="o">--</span><span class="n">keep</span><span class="p">:</span> <span class="mi">380</span> <span class="n">people</span> <span class="n">remaining</span><span class="o">.</span>
<span class="n">Using</span> <span class="mi">1</span> <span class="n">thread</span> <span class="p">(</span><span class="n">no</span> <span class="n">multithreaded</span> <span class="n">calculations</span> <span class="n">invoked</span><span class="p">)</span><span class="o">.</span>
<span class="n">Before</span> <span class="n">main</span> <span class="n">variant</span> <span class="n">filters</span><span class="p">,</span> <span class="mi">380</span> <span class="n">founders</span> <span class="ow">and</span> <span class="mi">0</span> <span class="n">nonfounders</span> <span class="n">present</span><span class="o">.</span>
<span class="n">Calculating</span> <span class="n">allele</span> <span class="n">frequencies</span><span class="o">...</span> <span class="mi">10111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394959697</span><span class="o">%</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ne">Warning</span><span class="p">:</span> <span class="o">--</span><span class="n">hwe</span> <span class="n">observation</span> <span class="n">counts</span> <span class="n">vary</span> <span class="n">by</span> <span class="n">more</span> <span class="n">than</span> <span class="mi">10</span><span class="o">%</span><span class="p">,</span> <span class="n">due</span> <span class="n">to</span> <span class="n">the</span> <span class="n">X</span>
<span class="n">chromosome</span><span class="o">.</span>  <span class="n">You</span> <span class="n">may</span> <span class="n">want</span> <span class="n">to</span> <span class="n">use</span> <span class="n">a</span> <span class="n">less</span> <span class="n">stringent</span> <span class="o">--</span><span class="n">hwe</span> <span class="n">p</span><span class="o">-</span><span class="n">value</span> <span class="n">threshold</span> <span class="k">for</span> <span class="n">X</span>
<span class="n">chromosome</span> <span class="n">variants</span><span class="o">.</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>989 done.
Total genotyping rate is 0.999923.
543113 variants and 380 people pass filters and QC.
Phenotype data is quantitative.
--het: 521800 variants scanned, report written to
SampleData1/Fold_1/train_data.QC.het .
[1] &quot;SampleData1/Fold_1&quot; &quot;train_data&quot;         &quot;train_data.QC&quot;
[4] &quot;1&quot;
[1] &quot;SampleData1&quot; &quot;Fold_1&quot;
[1] &quot;SampleData1&quot;
[1] 14
[1] 14
[1] 14
Rscript Module1.R SampleData1/Fold_1  train_data train_data.QC 1
PLINK v1.90b7.2 64-bit (11 Dec 2023)           www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to SampleData1/Fold_1/train_data.QC.log.
Options in effect:
  --bfile SampleData1/Fold_1/train_data
  --extract SampleData1/Fold_1/train_data.QC.snplist
  --out SampleData1/Fold_1/train_data.QC
  --rel-cutoff 0.125

63761 MB RAM detected; reserving 31880 MB for main workspace.
551892 variants loaded from .bim file.
380 people (178 males, 202 females) loaded from .fam.
380 phenotype values loaded from .fam.
--extract: 543113 variants remaining.
Using up to 8 threads (change this with --threads).
Before main variant filters, 380 founders and 0 nonfounders present.
Calculating allele frequencies... 10111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394959697989 done.
Total genotyping rate is 0.999923.
543113 variants and 380 people pass filters and QC (before --rel-cutoff).
Phenotype data is quantitative.
Excluding 21313 variants on non-autosomes from relationship matrix calc.
Relationship matrix calculation complete.
0 people excluded by --rel-cutoff.
Remaining sample IDs written to SampleData1/Fold_1/train_data.QC.rel.id .
PLINK v1.90b7.2 64-bit (11 Dec 2023)           www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to SampleData1/Fold_1/train_data.QC.log.
Options in effect:
  --a1-allele SampleData1/Fold_1/train_data.a1
  --bfile SampleData1/Fold_1/train_data
  --exclude SampleData1/Fold_1/train_data.mismatch
  --extract SampleData1/Fold_1/train_data.QC.snplist
  --keep SampleData1/Fold_1/train_data.QC.rel.id
  --make-bed
  --out SampleData1/Fold_1/train_data.QC

63761 MB RAM detected; reserving 31880 MB for main workspace.
551892 variants loaded from .bim file.
380 people (178 males, 202 females) loaded from .fam.
380 phenotype values loaded from .fam.
--extract: 543113 variants remaining.
--exclude: 492382 variants remaining.
--keep: 380 people remaining.
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 380 founders and 0 nonfounders present.
Calculating allele frequencies... 10111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394959697989 done.
Total genotyping rate is 0.99992.
--a1-allele: 492382 assignments made.
492382 variants and 380 people pass filters and QC.
Phenotype data is quantitative.
--make-bed to SampleData1/Fold_1/train_data.QC.bed +
SampleData1/Fold_1/train_data.QC.bim + SampleData1/Fold_1/train_data.QC.fam ...
101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899done.
PLINK v1.90b7.2 64-bit (11 Dec 2023)           www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to SampleData1/Fold_2/train_data.log.
Options in effect:
  --bfile SampleData1/SampleData1_QC
  --keep SampleData1/Fold_2/train_data.fam
  --make-bed
  --out SampleData1/Fold_2/train_data

63761 MB RAM detected; reserving 31880 MB for main workspace.
551892 variants loaded from .bim file.
475 people (227 males, 248 females) loaded from .fam.
475 phenotype values loaded from .fam.
--keep: 380 people remaining.
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 380 founders and 0 nonfounders present.
Calculating allele frequencies... 10111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394959697989 done.
Total genotyping rate in remaining samples is 0.999896.
551892 variants and 380 people pass filters and QC.
Phenotype data is quantitative.
--make-bed to SampleData1/Fold_2/train_data.bed +
SampleData1/Fold_2/train_data.bim + SampleData1/Fold_2/train_data.fam ... 101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899done.
PLINK v1.90b7.2 64-bit (11 Dec 2023)           www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to SampleData1/Fold_2/test_data.log.
Options in effect:
  --bfile SampleData1/SampleData1_QC
  --keep SampleData1/Fold_2/test_data.fam
  --make-bed
  --out SampleData1/Fold_2/test_data

63761 MB RAM detected; reserving 31880 MB for main workspace.
551892 variants loaded from .bim file.
475 people (227 males, 248 females) loaded from .fam.
475 phenotype values loaded from .fam.
--keep: 95 people remaining.
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 95 founders and 0 nonfounders present.
Calculating allele frequencies... 10111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394959697989 done.
Total genotyping rate in remaining samples is 0.999896.
551892 variants and 95 people pass filters and QC.
Phenotype data is quantitative.
--make-bed to SampleData1/Fold_2/test_data.bed +
SampleData1/Fold_2/test_data.bim + SampleData1/Fold_2/test_data.fam ... 101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899done.
PLINK v1.90b7.2 64-bit (11 Dec 2023)           www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to SampleData1/Fold_2/train_data.QC.log.
Options in effect:
  --bfile SampleData1/Fold_2/train_data
  --geno 0.1
  --hwe 1e-6
  --maf 0.01
  --make-just-fam
  --mind 0.1
  --out SampleData1/Fold_2/train_data.QC
  --write-snplist

63761 MB RAM detected; reserving 31880 MB for main workspace.
551892 variants loaded from .bim file.
380 people (180 males, 200 females) loaded from .fam.
380 phenotype values loaded from .fam.
0 people removed due to missing genotype data (--mind).
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 380 founders and 0 nonfounders present.
Calculating allele frequencies... 10111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394959697989 done.
Total genotyping rate is 0.999896.
1 variant removed due to missing genotype data (--geno).
--hwe: 847 variants removed due to Hardy-Weinberg exact test.
8536 variants removed due to minor allele threshold(s)
(--maf/--max-maf/--mac/--max-mac).
542508 variants and 380 people pass filters and QC.
Phenotype data is quantitative.
List of variant IDs written to SampleData1/Fold_2/train_data.QC.snplist .
--make-just-fam to SampleData1/Fold_2/train_data.QC.fam ... done.
PLINK v1.90b7.2 64-bit (11 Dec 2023)           www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to SampleData1/Fold_2/train_data.QC.log.
Options in effect:
  --bfile SampleData1/Fold_2/train_data
  --extract SampleData1/Fold_2/train_data.QC.snplist
  --het
  --keep SampleData1/Fold_2/train_data.QC.fam
  --out SampleData1/Fold_2/train_data.QC

63761 MB RAM detected; reserving 31880 MB for main workspace.
551892 variants loaded from .bim file.
380 people (180 males, 200 females) loaded from .fam.
380 phenotype values loaded from .fam.
--extract: 542508 variants remaining.
--keep: 380 people remaining.
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 380 founders and 0 nonfounders present.
Calculating allele frequencies... 1011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586%
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ne">Warning</span><span class="p">:</span> <span class="o">--</span><span class="n">hwe</span> <span class="n">observation</span> <span class="n">counts</span> <span class="n">vary</span> <span class="n">by</span> <span class="n">more</span> <span class="n">than</span> <span class="mi">10</span><span class="o">%</span><span class="p">,</span> <span class="n">due</span> <span class="n">to</span> <span class="n">the</span> <span class="n">X</span>
<span class="n">chromosome</span><span class="o">.</span>  <span class="n">You</span> <span class="n">may</span> <span class="n">want</span> <span class="n">to</span> <span class="n">use</span> <span class="n">a</span> <span class="n">less</span> <span class="n">stringent</span> <span class="o">--</span><span class="n">hwe</span> <span class="n">p</span><span class="o">-</span><span class="n">value</span> <span class="n">threshold</span> <span class="k">for</span> <span class="n">X</span>
<span class="n">chromosome</span> <span class="n">variants</span><span class="o">.</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>8788899091929394959697989 done.
Total genotyping rate is 0.999898.
542508 variants and 380 people pass filters and QC.
Phenotype data is quantitative.
--het: 521405 variants scanned, report written to
SampleData1/Fold_2/train_data.QC.het .
[1] &quot;SampleData1/Fold_2&quot; &quot;train_data&quot;         &quot;train_data.QC&quot;
[4] &quot;1&quot;
[1] &quot;SampleData1&quot; &quot;Fold_2&quot;
[1] &quot;SampleData1&quot;
[1] 14
[1] 14
[1] 14
Rscript Module1.R SampleData1/Fold_2  train_data train_data.QC 1
PLINK v1.90b7.2 64-bit (11 Dec 2023)           www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to SampleData1/Fold_2/train_data.QC.log.
Options in effect:
  --bfile SampleData1/Fold_2/train_data
  --extract SampleData1/Fold_2/train_data.QC.snplist
  --out SampleData1/Fold_2/train_data.QC
  --rel-cutoff 0.125

63761 MB RAM detected; reserving 31880 MB for main workspace.
551892 variants loaded from .bim file.
380 people (180 males, 200 females) loaded from .fam.
380 phenotype values loaded from .fam.
--extract: 542508 variants remaining.
Using up to 8 threads (change this with --threads).
Before main variant filters, 380 founders and 0 nonfounders present.
Calculating allele frequencies... 10111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394959697989 done.
Total genotyping rate is 0.999898.
542508 variants and 380 people pass filters and QC (before --rel-cutoff).
Phenotype data is quantitative.
Excluding 21103 variants on non-autosomes from relationship matrix calc.
Relationship matrix calculation complete.
0 people excluded by --rel-cutoff.
Remaining sample IDs written to SampleData1/Fold_2/train_data.QC.rel.id .
PLINK v1.90b7.2 64-bit (11 Dec 2023)           www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to SampleData1/Fold_2/train_data.QC.log.
Options in effect:
  --a1-allele SampleData1/Fold_2/train_data.a1
  --bfile SampleData1/Fold_2/train_data
  --exclude SampleData1/Fold_2/train_data.mismatch
  --extract SampleData1/Fold_2/train_data.QC.snplist
  --keep SampleData1/Fold_2/train_data.QC.rel.id
  --make-bed
  --out SampleData1/Fold_2/train_data.QC

63761 MB RAM detected; reserving 31880 MB for main workspace.
551892 variants loaded from .bim file.
380 people (180 males, 200 females) loaded from .fam.
380 phenotype values loaded from .fam.
--extract: 542508 variants remaining.
--exclude: 491965 variants remaining.
--keep: 380 people remaining.
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 380 founders and 0 nonfounders present.
Calculating allele frequencies... 10111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394959697989 done.
Total genotyping rate is 0.999894.
--a1-allele: 491965 assignments made.
491965 variants and 380 people pass filters and QC.
Phenotype data is quantitative.
--make-bed to SampleData1/Fold_2/train_data.QC.bed +
SampleData1/Fold_2/train_data.QC.bim + SampleData1/Fold_2/train_data.QC.fam ...
101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899done.
PLINK v1.90b7.2 64-bit (11 Dec 2023)           www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to SampleData1/Fold_3/train_data.log.
Options in effect:
  --bfile SampleData1/SampleData1_QC
  --keep SampleData1/Fold_3/train_data.fam
  --make-bed
  --out SampleData1/Fold_3/train_data

63761 MB RAM detected; reserving 31880 MB for main workspace.
551892 variants loaded from .bim file.
475 people (227 males, 248 females) loaded from .fam.
475 phenotype values loaded from .fam.
--keep: 380 people remaining.
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 380 founders and 0 nonfounders present.
Calculating allele frequencies... 10111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394959697989 done.
Total genotyping rate in remaining samples is 0.999871.
551892 variants and 380 people pass filters and QC.
Phenotype data is quantitative.
--make-bed to SampleData1/Fold_3/train_data.bed +
SampleData1/Fold_3/train_data.bim + SampleData1/Fold_3/train_data.fam ... 101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899done.
PLINK v1.90b7.2 64-bit (11 Dec 2023)           www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to SampleData1/Fold_3/test_data.log.
Options in effect:
  --bfile SampleData1/SampleData1_QC
  --keep SampleData1/Fold_3/test_data.fam
  --make-bed
  --out SampleData1/Fold_3/test_data

63761 MB RAM detected; reserving 31880 MB for main workspace.
551892 variants loaded from .bim file.
475 people (227 males, 248 females) loaded from .fam.
475 phenotype values loaded from .fam.
--keep: 95 people remaining.
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 95 founders and 0 nonfounders present.
Calculating allele frequencies... 10111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394959697989 done.
Total genotyping rate in remaining samples is 0.999998.
551892 variants and 95 people pass filters and QC.
Phenotype data is quantitative.
--make-bed to SampleData1/Fold_3/test_data.bed +
SampleData1/Fold_3/test_data.bim + SampleData1/Fold_3/test_data.fam ... 101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899done.
PLINK v1.90b7.2 64-bit (11 Dec 2023)           www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to SampleData1/Fold_3/train_data.QC.log.
Options in effect:
  --bfile SampleData1/Fold_3/train_data
  --geno 0.1
  --hwe 1e-6
  --maf 0.01
  --make-just-fam
  --mind 0.1
  --out SampleData1/Fold_3/train_data.QC
  --write-snplist

63761 MB RAM detected; reserving 31880 MB for main workspace.
551892 variants loaded from .bim file.
380 people (181 males, 199 females) loaded from .fam.
380 phenotype values loaded from .fam.
0 people removed due to missing genotype data (--mind).
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 380 founders and 0 nonfounders present.
Calculating allele frequencies... 10111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394959697989 done.
Total genotyping rate is 0.999871.
1 variant removed due to missing genotype data (--geno).
--hwe: 841 variants removed due to Hardy-Weinberg exact test.
8339 variants removed due to minor allele threshold(s)
(--maf/--max-maf/--mac/--max-mac).
542711 variants and 380 people pass filters and QC.
Phenotype data is quantitative.
List of variant IDs written to SampleData1/Fold_3/train_data.QC.snplist .
--make-just-fam to SampleData1/Fold_3/train_data.QC.fam ... done.
PLINK v1.90b7.2 64-bit (11 Dec 2023)           www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to SampleData1/Fold_3/train_data.QC.log.
Options in effect:
  --bfile SampleData1/Fold_3/train_data
  --extract SampleData1/Fold_3/train_data.QC.snplist
  --het
  --keep SampleData1/Fold_3/train_data.QC.fam
  --out SampleData1/Fold_3/train_data.QC

63761 MB RAM detected; reserving 31880 MB for main workspace.
551892 variants loaded from .bim file.
380 people (181 males, 199 females) loaded from .fam.
380 phenotype values loaded from .fam.
--extract: 542711 variants remaining.
--keep: 380 people remaining.
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 380 founders and 0 nonfounders present.
Calculating allele frequencies... 10111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182%
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ne">Warning</span><span class="p">:</span> <span class="o">--</span><span class="n">hwe</span> <span class="n">observation</span> <span class="n">counts</span> <span class="n">vary</span> <span class="n">by</span> <span class="n">more</span> <span class="n">than</span> <span class="mi">10</span><span class="o">%</span><span class="p">,</span> <span class="n">due</span> <span class="n">to</span> <span class="n">the</span> <span class="n">X</span>
<span class="n">chromosome</span><span class="o">.</span>  <span class="n">You</span> <span class="n">may</span> <span class="n">want</span> <span class="n">to</span> <span class="n">use</span> <span class="n">a</span> <span class="n">less</span> <span class="n">stringent</span> <span class="o">--</span><span class="n">hwe</span> <span class="n">p</span><span class="o">-</span><span class="n">value</span> <span class="n">threshold</span> <span class="k">for</span> <span class="n">X</span>
<span class="n">chromosome</span> <span class="n">variants</span><span class="o">.</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>838485868788899091929394959697989 done.
Total genotyping rate is 0.999872.
542711 variants and 380 people pass filters and QC.
Phenotype data is quantitative.
--het: 521511 variants scanned, report written to
SampleData1/Fold_3/train_data.QC.het .
[1] &quot;SampleData1/Fold_3&quot; &quot;train_data&quot;         &quot;train_data.QC&quot;
[4] &quot;1&quot;
[1] &quot;SampleData1&quot; &quot;Fold_3&quot;
[1] &quot;SampleData1&quot;
[1] 14
[1] 14
[1] 14
Rscript Module1.R SampleData1/Fold_3  train_data train_data.QC 1
PLINK v1.90b7.2 64-bit (11 Dec 2023)           www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to SampleData1/Fold_3/train_data.QC.log.
Options in effect:
  --bfile SampleData1/Fold_3/train_data
  --extract SampleData1/Fold_3/train_data.QC.snplist
  --out SampleData1/Fold_3/train_data.QC
  --rel-cutoff 0.125

63761 MB RAM detected; reserving 31880 MB for main workspace.
551892 variants loaded from .bim file.
380 people (181 males, 199 females) loaded from .fam.
380 phenotype values loaded from .fam.
--extract: 542711 variants remaining.
Using up to 8 threads (change this with --threads).
Before main variant filters, 380 founders and 0 nonfounders present.
Calculating allele frequencies... 10111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394959697989 done.
Total genotyping rate is 0.999872.
542711 variants and 380 people pass filters and QC (before --rel-cutoff).
Phenotype data is quantitative.
Excluding 21200 variants on non-autosomes from relationship matrix calc.
Relationship matrix calculation complete.
0 people excluded by --rel-cutoff.
Remaining sample IDs written to SampleData1/Fold_3/train_data.QC.rel.id .
PLINK v1.90b7.2 64-bit (11 Dec 2023)           www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to SampleData1/Fold_3/train_data.QC.log.
Options in effect:
  --a1-allele SampleData1/Fold_3/train_data.a1
  --bfile SampleData1/Fold_3/train_data
  --exclude SampleData1/Fold_3/train_data.mismatch
  --extract SampleData1/Fold_3/train_data.QC.snplist
  --keep SampleData1/Fold_3/train_data.QC.rel.id
  --make-bed
  --out SampleData1/Fold_3/train_data.QC

63761 MB RAM detected; reserving 31880 MB for main workspace.
551892 variants loaded from .bim file.
380 people (181 males, 199 females) loaded from .fam.
380 phenotype values loaded from .fam.
--extract: 542711 variants remaining.
--exclude: 492072 variants remaining.
--keep: 380 people remaining.
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 380 founders and 0 nonfounders present.
Calculating allele frequencies... 10111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394959697989 done.
Total genotyping rate is 0.999868.
--a1-allele: 492072 assignments made.
492072 variants and 380 people pass filters and QC.
Phenotype data is quantitative.
--make-bed to SampleData1/Fold_3/train_data.QC.bed +
SampleData1/Fold_3/train_data.QC.bim + SampleData1/Fold_3/train_data.QC.fam ...
101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899done.
PLINK v1.90b7.2 64-bit (11 Dec 2023)           www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to SampleData1/Fold_4/train_data.log.
Options in effect:
  --bfile SampleData1/SampleData1_QC
  --keep SampleData1/Fold_4/train_data.fam
  --make-bed
  --out SampleData1/Fold_4/train_data

63761 MB RAM detected; reserving 31880 MB for main workspace.
551892 variants loaded from .bim file.
475 people (227 males, 248 females) loaded from .fam.
475 phenotype values loaded from .fam.
--keep: 380 people remaining.
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 380 founders and 0 nonfounders present.
Calculating allele frequencies... 10111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394959697989 done.
Total genotyping rate in remaining samples is 0.999896.
551892 variants and 380 people pass filters and QC.
Phenotype data is quantitative.
--make-bed to SampleData1/Fold_4/train_data.bed +
SampleData1/Fold_4/train_data.bim + SampleData1/Fold_4/train_data.fam ... 101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899done.
PLINK v1.90b7.2 64-bit (11 Dec 2023)           www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to SampleData1/Fold_4/test_data.log.
Options in effect:
  --bfile SampleData1/SampleData1_QC
  --keep SampleData1/Fold_4/test_data.fam
  --make-bed
  --out SampleData1/Fold_4/test_data

63761 MB RAM detected; reserving 31880 MB for main workspace.
551892 variants loaded from .bim file.
475 people (227 males, 248 females) loaded from .fam.
475 phenotype values loaded from .fam.
--keep: 95 people remaining.
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 95 founders and 0 nonfounders present.
Calculating allele frequencies... 10111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394959697989 done.
Total genotyping rate in remaining samples is 0.999896.
551892 variants and 95 people pass filters and QC.
Phenotype data is quantitative.
--make-bed to SampleData1/Fold_4/test_data.bed +
SampleData1/Fold_4/test_data.bim + SampleData1/Fold_4/test_data.fam ... 101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899done.
PLINK v1.90b7.2 64-bit (11 Dec 2023)           www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to SampleData1/Fold_4/train_data.QC.log.
Options in effect:
  --bfile SampleData1/Fold_4/train_data
  --geno 0.1
  --hwe 1e-6
  --maf 0.01
  --make-just-fam
  --mind 0.1
  --out SampleData1/Fold_4/train_data.QC
  --write-snplist

63761 MB RAM detected; reserving 31880 MB for main workspace.
551892 variants loaded from .bim file.
380 people (186 males, 194 females) loaded from .fam.
380 phenotype values loaded from .fam.
0 people removed due to missing genotype data (--mind).
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 380 founders and 0 nonfounders present.
Calculating allele frequencies... 10111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394959697989 done.
Total genotyping rate is 0.999896.
1 variant removed due to missing genotype data (--geno).
--hwe: 828 variants removed due to Hardy-Weinberg exact test.
8533 variants removed due to minor allele threshold(s)
(--maf/--max-maf/--mac/--max-mac).
542530 variants and 380 people pass filters and QC.
Phenotype data is quantitative.
List of variant IDs written to SampleData1/Fold_4/train_data.QC.snplist .
--make-just-fam to SampleData1/Fold_4/train_data.QC.fam ... done.
PLINK v1.90b7.2 64-bit (11 Dec 2023)           www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to SampleData1/Fold_4/train_data.QC.log.
Options in effect:
  --bfile SampleData1/Fold_4/train_data
  --extract SampleData1/Fold_4/train_data.QC.snplist
  --het
  --keep SampleData1/Fold_4/train_data.QC.fam
  --out SampleData1/Fold_4/train_data.QC

63761 MB RAM detected; reserving 31880 MB for main workspace.
551892 variants loaded from .bim file.
380 people (186 males, 194 females) loaded from .fam.
380 phenotype values loaded from .fam.
--extract: 542530 variants remaining.
--keep: 380 people remaining.
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 380 founders and 0 nonfounders present.
Calculating allele frequencies... 101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596%
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ne">Warning</span><span class="p">:</span> <span class="o">--</span><span class="n">hwe</span> <span class="n">observation</span> <span class="n">counts</span> <span class="n">vary</span> <span class="n">by</span> <span class="n">more</span> <span class="n">than</span> <span class="mi">10</span><span class="o">%</span><span class="p">,</span> <span class="n">due</span> <span class="n">to</span> <span class="n">the</span> <span class="n">X</span>
<span class="n">chromosome</span><span class="o">.</span>  <span class="n">You</span> <span class="n">may</span> <span class="n">want</span> <span class="n">to</span> <span class="n">use</span> <span class="n">a</span> <span class="n">less</span> <span class="n">stringent</span> <span class="o">--</span><span class="n">hwe</span> <span class="n">p</span><span class="o">-</span><span class="n">value</span> <span class="n">threshold</span> <span class="k">for</span> <span class="n">X</span>
<span class="n">chromosome</span> <span class="n">variants</span><span class="o">.</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>97989 done.
Total genotyping rate is 0.999898.
542530 variants and 380 people pass filters and QC.
Phenotype data is quantitative.
--het: 521557 variants scanned, report written to
SampleData1/Fold_4/train_data.QC.het .
[1] &quot;SampleData1/Fold_4&quot; &quot;train_data&quot;         &quot;train_data.QC&quot;
[4] &quot;1&quot;
[1] &quot;SampleData1&quot; &quot;Fold_4&quot;
[1] &quot;SampleData1&quot;
[1] 14
[1] 14
[1] 14
Rscript Module1.R SampleData1/Fold_4  train_data train_data.QC 1
PLINK v1.90b7.2 64-bit (11 Dec 2023)           www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to SampleData1/Fold_4/train_data.QC.log.
Options in effect:
  --bfile SampleData1/Fold_4/train_data
  --extract SampleData1/Fold_4/train_data.QC.snplist
  --out SampleData1/Fold_4/train_data.QC
  --rel-cutoff 0.125

63761 MB RAM detected; reserving 31880 MB for main workspace.
551892 variants loaded from .bim file.
380 people (186 males, 194 females) loaded from .fam.
380 phenotype values loaded from .fam.
--extract: 542530 variants remaining.
Using up to 8 threads (change this with --threads).
Before main variant filters, 380 founders and 0 nonfounders present.
Calculating allele frequencies... 10111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394959697989 done.
Total genotyping rate is 0.999898.
542530 variants and 380 people pass filters and QC (before --rel-cutoff).
Phenotype data is quantitative.
Excluding 20973 variants on non-autosomes from relationship matrix calc.
Relationship matrix calculation complete.
0 people excluded by --rel-cutoff.
Remaining sample IDs written to SampleData1/Fold_4/train_data.QC.rel.id .
PLINK v1.90b7.2 64-bit (11 Dec 2023)           www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to SampleData1/Fold_4/train_data.QC.log.
Options in effect:
  --a1-allele SampleData1/Fold_4/train_data.a1
  --bfile SampleData1/Fold_4/train_data
  --exclude SampleData1/Fold_4/train_data.mismatch
  --extract SampleData1/Fold_4/train_data.QC.snplist
  --keep SampleData1/Fold_4/train_data.QC.rel.id
  --make-bed
  --out SampleData1/Fold_4/train_data.QC

63761 MB RAM detected; reserving 31880 MB for main workspace.
551892 variants loaded from .bim file.
380 people (186 males, 194 females) loaded from .fam.
380 phenotype values loaded from .fam.
--extract: 542530 variants remaining.
--exclude: 492135 variants remaining.
--keep: 380 people remaining.
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 380 founders and 0 nonfounders present.
Calculating allele frequencies... 10111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394959697989 done.
Total genotyping rate is 0.999894.
--a1-allele: 492135 assignments made.
492135 variants and 380 people pass filters and QC.
Phenotype data is quantitative.
--make-bed to SampleData1/Fold_4/train_data.QC.bed +
SampleData1/Fold_4/train_data.QC.bim + SampleData1/Fold_4/train_data.QC.fam ...
101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899done.
</pre></div>
</div>
</section>
</section>
<section id="check-final-files">
<h2>Check final files.<a class="headerlink" href="#check-final-files" title="Link to this heading"></a></h2>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>

<span class="c1"># List of file names to check for existence</span>
<span class="n">files</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;train_data.QC.bed&quot;</span><span class="p">,</span>
    <span class="s2">&quot;train_data.QC.bim&quot;</span><span class="p">,</span>
    <span class="s2">&quot;train_data.QC.fam&quot;</span><span class="p">,</span>
    <span class="s2">&quot;train_data.cov&quot;</span><span class="p">,</span>
    <span class="s2">&quot;test_data.bed&quot;</span><span class="p">,</span>
    <span class="s2">&quot;test_data.bim&quot;</span><span class="p">,</span>
    <span class="s2">&quot;test_data.fam&quot;</span><span class="p">,</span>
    <span class="s2">&quot;test_data.cov&quot;</span>
<span class="p">]</span>

<span class="c1"># Directory where the files are expected to be found</span>

<span class="c1"># Print the table header</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:&lt;20}</span><span class="s2"> </span><span class="si">{:&lt;5}</span><span class="s2"> </span><span class="si">{:&lt;5}</span><span class="s2"> </span><span class="si">{:&lt;5}</span><span class="s2"> </span><span class="si">{:&lt;5}</span><span class="s2"> </span><span class="si">{:&lt;5}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;File Name&quot;</span><span class="p">,</span> <span class="s2">&quot;Fold 0&quot;</span><span class="p">,</span> <span class="s2">&quot;Fold 1&quot;</span><span class="p">,</span> <span class="s2">&quot;Fold 2&quot;</span><span class="p">,</span> <span class="s2">&quot;Fold 3&quot;</span><span class="p">,</span> <span class="s2">&quot;Fold 4&quot;</span><span class="p">))</span>

<span class="c1"># Loop through each file name in the list</span>
<span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
    <span class="c1"># Create a list to store the existence status for each fold</span>
    <span class="n">status</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># Check for each fold from 0 to 4</span>
    <span class="k">for</span> <span class="n">fold_number</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
        <span class="c1"># Check if the file exists in the specified directory for the given fold</span>
        <span class="c1">#print(os.path.join(&quot;./&quot;,filedirec, f&quot;Fold_{fold_number}&quot;, file))</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">filedirec</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="s2">&quot;Fold_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">fold_number</span><span class="p">)</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="n">file</span><span class="p">):</span>
            <span class="n">status</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;yes&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">status</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;no&quot;</span><span class="p">)</span>

    <span class="c1"># Print the file name and its status for each fold</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:&lt;20}</span><span class="s2"> </span><span class="si">{:&lt;5}</span><span class="s2"> </span><span class="si">{:&lt;5}</span><span class="s2"> </span><span class="si">{:&lt;5}</span><span class="s2"> </span><span class="si">{:&lt;5}</span><span class="s2"> </span><span class="si">{:&lt;5}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="o">*</span><span class="n">status</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">File</span> <span class="n">Name</span>            <span class="n">Fold</span> <span class="mi">0</span> <span class="n">Fold</span> <span class="mi">1</span> <span class="n">Fold</span> <span class="mi">2</span> <span class="n">Fold</span> <span class="mi">3</span> <span class="n">Fold</span> <span class="mi">4</span>
<span class="n">train_data</span><span class="o">.</span><span class="n">QC</span><span class="o">.</span><span class="n">bed</span>    <span class="n">yes</span>   <span class="n">yes</span>   <span class="n">yes</span>   <span class="n">yes</span>   <span class="n">yes</span>
<span class="n">train_data</span><span class="o">.</span><span class="n">QC</span><span class="o">.</span><span class="n">bim</span>    <span class="n">yes</span>   <span class="n">yes</span>   <span class="n">yes</span>   <span class="n">yes</span>   <span class="n">yes</span>
<span class="n">train_data</span><span class="o">.</span><span class="n">QC</span><span class="o">.</span><span class="n">fam</span>    <span class="n">yes</span>   <span class="n">yes</span>   <span class="n">yes</span>   <span class="n">yes</span>   <span class="n">yes</span>
<span class="n">train_data</span><span class="o">.</span><span class="n">cov</span>       <span class="n">yes</span>   <span class="n">yes</span>   <span class="n">yes</span>   <span class="n">yes</span>   <span class="n">yes</span>
<span class="n">test_data</span><span class="o">.</span><span class="n">bed</span>        <span class="n">yes</span>   <span class="n">yes</span>   <span class="n">yes</span>   <span class="n">yes</span>   <span class="n">yes</span>
<span class="n">test_data</span><span class="o">.</span><span class="n">bim</span>        <span class="n">yes</span>   <span class="n">yes</span>   <span class="n">yes</span>   <span class="n">yes</span>   <span class="n">yes</span>
<span class="n">test_data</span><span class="o">.</span><span class="n">fam</span>        <span class="n">yes</span>   <span class="n">yes</span>   <span class="n">yes</span>   <span class="n">yes</span>   <span class="n">yes</span>
<span class="n">test_data</span><span class="o">.</span><span class="n">cov</span>        <span class="n">yes</span>   <span class="n">yes</span>   <span class="n">yes</span>   <span class="n">yes</span>   <span class="n">yes</span>
</pre></div>
</div>
<p>We will have the following directories if everything works fine.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>├── Fold_0
│   ├── test_data.bed
│   ├── test_data.bim
│   ├── test_data.cov
│   ├── test_data.fam
│   ├── test_data.log
│   ├── train_data.a1
│   ├── train_data.bed
│   ├── train_data.bim
│   ├── train_data.cov
│   ├── train_data.fam
│   ├── train_data.log
│   ├── train_data.mismatch
│   ├── train_data.QC.bed
│   ├── train_data.QC.bim
│   ├── train_data.QC.fam
│   ├── train_data.QC.het
│   ├── train_data.QC.log
│   ├── train_data.QC.rel.id
│   ├── train_data.QC.sexcheck
│   ├── train_data.QC.snplist
│   ├── train_data.QC.valid
│   └── train_data.valid.sample
├── Fold_1

├── Fold_2

├── Fold_3

├── Fold_4

├── PeopleWithPhenotype.txt
├── SampleData1.bed
├── SampleData1.bim
├── SampleData1.cov
├── SampleData1.fam
├── SampleData1.gz
├── SampleData1.height
├── SampleData1_QC.bed
├── SampleData1_QC.bim
├── SampleData1_QC.cov
├── SampleData1_QC.fam
└── SampleData1_QC.log
</pre></div>
</div>
</section>
<section id="important-note">
<h2>Important Note<a class="headerlink" href="#important-note" title="Link to this heading"></a></h2>
<ol class="arabic simple">
<li><p>Kindly ensure you have all the files required for the next step after
the completion of this step.</p></li>
<li><p>It is better to pass the dataset on which quality controls have
already been performed.</p></li>
<li><p>We considered genotype files for which chromosomes 1 to 22 are
available, and sex information is present. If you want to use the
function in the script to check the sex information, ensure the
genotype file includes other chromosomes as well.</p></li>
<li><p>Go through the logs generated by the code if an error occurs. Even if
no error occurs, it is always good to ensure that the log file does
not produce any errors.</p></li>
</ol>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="Step1-DownloadSampleDataandSetupEnvironment.html" class="btn btn-neutral float-left" title="Step1-DownloadSampleDataandSetupEnvironment" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="NotebooksWorkflow.html" class="btn btn-neutral float-right" title="Polygenic Risk Score Tools Notebooks Workflow" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Muhammad Muneeb.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>