<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Polygenic Risk Score Tools Notebooks Workflow &mdash; Polygenic Risk Score Tools 1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=f2a433a1"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Plink" href="Plink.html" />
    <link rel="prev" title="Step2-GWASAndIndividualGenotypeDataQualityControls" href="Step2-GWASAndIndividualGenotypeDataQualityControls.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Polygenic Risk Score Tools
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Step1-DownloadSampleDataandSetupEnvironment.html">Step1-DownloadSampleDataandSetupEnvironment</a></li>
<li class="toctree-l1"><a class="reference internal" href="Step2-GWASAndIndividualGenotypeDataQualityControls.html">Step2-GWASAndIndividualGenotypeDataQualityControls</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Polygenic Risk Score Tools Notebooks Workflow</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#polygenic-risk-scores-tool-overview">1. Polygenic Risk Scores Tool Overview</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#installation-process">Installation Process</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#gwas-modification">2. GWAS Modification</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#gwas-processing">GWAS Processing</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#define-plink-hyperparameters">3. Define Plink Hyperparameters</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#define-prs-hyperparameters">Define PRS Hyperparameters</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#helper-functions-for-cleaning-data">4. Helper Functions for Cleaning Data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#define-clumping-pruning-functions-and-functions-to-fit-the-prs">Define Clumping/Pruning Functions and Functions to Fit the PRS</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#execute-tool">5. Execute Tool</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#execute-the-code-for-a-specific-tool">Execute the Code for a Specific Tool</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#repeat-the-process-for-each-fold">6. Repeat the Process for Each Fold</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#change-the-fold-number-in-the-3rd-step">Change the Fold Number in the 3rd Step</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#evaluate-the-results">7. Evaluate the Results</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#find-the-best-performing-parameters">Find the Best-Performing Parameters</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#conclusion">8. Conclusion</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#review-logs-generated-by-the-notebook">Review Logs Generated by the Notebook</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Plink.html">Plink</a></li>
<li class="toctree-l1"><a class="reference internal" href="PRSice-2.html">PRSice-2</a></li>
<li class="toctree-l1"><a class="reference internal" href="DBSLMM.html">DBSLMM</a></li>
<li class="toctree-l1"><a class="reference internal" href="GCTA.html">GCTA</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lassosum.html">Lassosum</a></li>
<li class="toctree-l1"><a class="reference internal" href="LDpred-2-Inf.html">LDpred-2-Inf</a></li>
<li class="toctree-l1"><a class="reference internal" href="LDpred-2-Grid.html">LDpred-2-Grid</a></li>
<li class="toctree-l1"><a class="reference internal" href="LDpred-2-Auto.html">LDpred-2-Auto</a></li>
<li class="toctree-l1"><a class="reference internal" href="LDpred-2-Lassosum.html">LDpred-2-Lassosum</a></li>
<li class="toctree-l1"><a class="reference internal" href="LDpred-funct-code.html">LDpred-funct</a></li>
<li class="toctree-l1"><a class="reference internal" href="GCTB-SBayesR.html">GCTB: Calculating PRS with SBayesR</a></li>
<li class="toctree-l1"><a class="reference internal" href="GCTB-SBayesRC.html">GCTB-SBayesRC</a></li>
<li class="toctree-l1"><a class="reference internal" href="LDAK-GenotypeData.html">LDAK-GenotypeData</a></li>
<li class="toctree-l1"><a class="reference internal" href="LDAK-GWAS.html">LDAK-GWAS</a></li>
<li class="toctree-l1"><a class="reference internal" href="PRScs.html">PRScs</a></li>
<li class="toctree-l1"><a class="reference internal" href="PRScsx.html">PRScsx</a></li>
<li class="toctree-l1"><a class="reference internal" href="tlpSum.html">tlpSum</a></li>
<li class="toctree-l1"><a class="reference internal" href="PRSbils.html">PRSbils</a></li>
<li class="toctree-l1"><a class="reference internal" href="CTPR.html">CTPR</a></li>
<li class="toctree-l1"><a class="reference internal" href="NPS.html">NPS</a></li>
<li class="toctree-l1"><a class="reference internal" href="SDPR.html">SDPR</a></li>
<li class="toctree-l1"><a class="reference internal" href="PANPRS.html">PANPRS</a></li>
<li class="toctree-l1"><a class="reference internal" href="BOLT-LMM.html">BOLT-LMM</a></li>
<li class="toctree-l1"><a class="reference internal" href="RapidoPGS-single.html">RapidoPGS-single</a></li>
<li class="toctree-l1"><a class="reference internal" href="LDpred-gibbs.html">LDpred-gibbs</a></li>
<li class="toctree-l1"><a class="reference internal" href="LDpred-fast.html">LDpred-fast</a></li>
<li class="toctree-l1"><a class="reference internal" href="LDpred-p%2Bt.html">LDpred-p+t</a></li>
<li class="toctree-l1"><a class="reference internal" href="LDpred-inf.html">LDpred-inf</a></li>
<li class="toctree-l1"><a class="reference internal" href="AnnoPredCode.html">AnnoPred</a></li>
<li class="toctree-l1"><a class="reference internal" href="smtpred-wMtOLS.html">smtpred</a></li>
<li class="toctree-l1"><a class="reference internal" href="smtpred-wMtSBLUP.html">smtpred</a></li>
<li class="toctree-l1"><a class="reference internal" href="C%2BT.html">C+T</a></li>
<li class="toctree-l1"><a class="reference internal" href="viprs-simple.html">VIPRS-simple</a></li>
<li class="toctree-l1"><a class="reference internal" href="viprs-grid.html">VIPRS-grid</a></li>
<li class="toctree-l1"><a class="reference internal" href="HAIL.html">HAIL</a></li>
<li class="toctree-l1"><a class="reference internal" href="GEMMA-LM.html">GEMMA-LM</a></li>
<li class="toctree-l1"><a class="reference internal" href="GEMMA-LMM.html">GEMMA-LMM</a></li>
<li class="toctree-l1"><a class="reference internal" href="GEMMA-BSLMM.html">GEMMA-BSLMM</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Polygenic Risk Score Tools</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Polygenic Risk Score Tools Notebooks Workflow</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/NotebooksWorkflow.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <figure class="align-default" id="id1">
<img alt="NotebookWorkflowFinal" src="_images/NotebookWorkflowFinal.png" />
<figcaption>
<p><span class="caption-text">NotebookWorkflowFinal</span><a class="headerlink" href="#id1" title="Link to this image"></a></p>
</figcaption>
</figure>
<section id="polygenic-risk-score-tools-notebooks-workflow">
<h1>Polygenic Risk Score Tools Notebooks Workflow<a class="headerlink" href="#polygenic-risk-score-tools-notebooks-workflow" title="Link to this heading"></a></h1>
<p><strong>Notebooks for each tool are organized in the following format:</strong></p>
<section id="polygenic-risk-scores-tool-overview">
<h2>1. Polygenic Risk Scores Tool Overview<a class="headerlink" href="#polygenic-risk-scores-tool-overview" title="Link to this heading"></a></h2>
<section id="installation-process">
<h3>Installation Process<a class="headerlink" href="#installation-process" title="Link to this heading"></a></h3>
<p><strong>Documentation/GitHub/Tool Link</strong></p>
<ul class="simple">
<li><p>Discussed the process of installing the tool.</p></li>
<li><p>Whether the tool requires Python 2 or 3.</p></li>
<li><p>Checked if the tool relies on any other tools or datasets for
calculation.</p></li>
<li><p>Specified the hyperparameters offered by the tool.</p></li>
<li><p>Highlighted the hyperparameters we considered.</p></li>
</ul>
</section>
</section>
<section id="gwas-modification">
<h2>2. GWAS Modification<a class="headerlink" href="#gwas-modification" title="Link to this heading"></a></h2>
<section id="gwas-processing">
<h3>GWAS Processing<a class="headerlink" href="#gwas-processing" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>Modified the GWAS file as required by the specific tool.</p></li>
<li><p>PRS tools expect the GWAS file to:</p>
<ul>
<li><p>Be in a specific format.</p></li>
<li><p>Have specific headers.</p></li>
<li><p>GWAS should be in a specific format before it is passed to
Notebook/Code.</p></li>
</ul>
</li>
<li><p>Continuous phenotypes: Ensure the <code class="docutils literal notranslate"><span class="pre">BETA</span></code> (effect size) column is in
the GWAS.</p></li>
<li><p>Binary phenotypes: Ensure the <code class="docutils literal notranslate"><span class="pre">OR</span></code> (odd ratio) column is in the
GWAS.</p></li>
</ul>
</section>
</section>
<section id="define-plink-hyperparameters">
<h2>3. Define Plink Hyperparameters<a class="headerlink" href="#define-plink-hyperparameters" title="Link to this heading"></a></h2>
<section id="define-prs-hyperparameters">
<h3>Define PRS Hyperparameters<a class="headerlink" href="#define-prs-hyperparameters" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>Specified clumping and pruning parameters for the genotype data.</p></li>
<li><p>Defined the number of principal components (PCA).</p></li>
<li><p>Defined the number of p-value thresholds (More p-values, better
results. PRS is calculated for each p-value threshold. Combined PRS
with covariates and PCA for the final prediction).</p></li>
<li><p>Specified the fold number for which the code should be executed.</p></li>
</ul>
</section>
</section>
<section id="helper-functions-for-cleaning-data">
<h2>4. Helper Functions for Cleaning Data<a class="headerlink" href="#helper-functions-for-cleaning-data" title="Link to this heading"></a></h2>
<section id="define-clumping-pruning-functions-and-functions-to-fit-the-prs">
<h3>Define Clumping/Pruning Functions and Functions to Fit the PRS<a class="headerlink" href="#define-clumping-pruning-functions-and-functions-to-fit-the-prs" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>Defined a function to calculate PCA from the genotype data.</p></li>
<li><p>Defined a function to perform clumping and pruning.</p></li>
<li><p>Defined a function to fit the binary phenotype using logistic
regression (<code class="docutils literal notranslate"><span class="pre">LOGIT</span></code>).</p>
<ul>
<li><p>Merges covariates, PCA, and PRS.</p></li>
<li><p>One can use different regularization terms when fitting the model.</p></li>
<li><p>One can use different evaluation metrics.</p></li>
</ul>
</li>
<li><p>Defined a function to fit the continuous phenotype using ordinary
least squares (<code class="docutils literal notranslate"><span class="pre">OLS</span></code>).</p>
<ul>
<li><p>Merges covariates, PCA, and PRS.</p></li>
<li><p>One can use different regularization terms when fitting the model.</p></li>
<li><p>One can use different evaluation metrics.</p></li>
</ul>
</li>
</ul>
</section>
</section>
<section id="execute-tool">
<h2>5. Execute Tool<a class="headerlink" href="#execute-tool" title="Link to this heading"></a></h2>
<section id="execute-the-code-for-a-specific-tool">
<h3>Execute the Code for a Specific Tool<a class="headerlink" href="#execute-the-code-for-a-specific-tool" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>Deleted files from previous iterations.</p></li>
<li><p>Executed the code for the specific tool, phenotype, and fold.</p></li>
<li><p>Modified the GWAS and genotype files if required by the tool.</p></li>
<li><p>For some tools, genotype data must be split across each phenotype.</p></li>
<li><p>Calculated additional parameters, such as heritability for <code class="docutils literal notranslate"><span class="pre">GCTA</span></code>,
if needed.</p></li>
<li><p>Calculated the PRS using <code class="docutils literal notranslate"><span class="pre">PLINK</span></code> with posterior effect sizes
estimated by the tool.</p></li>
<li><p>Saved the results.</p></li>
</ul>
</section>
</section>
<section id="repeat-the-process-for-each-fold">
<h2>6. Repeat the Process for Each Fold<a class="headerlink" href="#repeat-the-process-for-each-fold" title="Link to this heading"></a></h2>
<section id="change-the-fold-number-in-the-3rd-step">
<h3>Change the Fold Number in the 3rd Step<a class="headerlink" href="#change-the-fold-number-in-the-3rd-step" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>Verified that the result file was generated.</p></li>
<li><p>Checked the number of rows in the result file.</p></li>
<li><p>Changed the fold number and executed the code for each fold.</p></li>
<li><p>Ensured that files were generated for each fold.</p></li>
<li><p>Summed the results across all folds, making sure the sum corresponds
to the correct rows.</p></li>
<li><p>If the code failed for some datasets (e.g., negative heritability),
discarded those rows for that fold.</p></li>
</ul>
</section>
</section>
<section id="evaluate-the-results">
<h2>7. Evaluate the Results<a class="headerlink" href="#evaluate-the-results" title="Link to this heading"></a></h2>
<section id="find-the-best-performing-parameters">
<h3>Find the Best-Performing Parameters<a class="headerlink" href="#find-the-best-performing-parameters" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>Identified the best performance parameters across all folds.</p></li>
<li><p>Used two methods to report performance:</p>
<ul>
<li><p>The test performance corresponding to the highest training
performance across all rows.</p></li>
<li><p>Generalized performance where the difference between train and
test performance is minimal, but their sum is high.</p></li>
</ul>
</li>
</ul>
</section>
</section>
<section id="conclusion">
<h2>8. Conclusion<a class="headerlink" href="#conclusion" title="Link to this heading"></a></h2>
<section id="review-logs-generated-by-the-notebook">
<h3>Review Logs Generated by the Notebook<a class="headerlink" href="#review-logs-generated-by-the-notebook" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>Performed various analyses, such as:</p>
<ul>
<li><p>Assessing the impact of different hyperparameters on performance.</p></li>
<li><p>Plotting the correlation between hyperparameters and train and
test performance.</p></li>
<li><p>Reporting the p-values that yield the best performance.</p></li>
</ul>
</li>
<li><p>Reviewed the logs generated by the notebook to ensure proper
execution.</p></li>
</ul>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="Step2-GWASAndIndividualGenotypeDataQualityControls.html" class="btn btn-neutral float-left" title="Step2-GWASAndIndividualGenotypeDataQualityControls" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="Plink.html" class="btn btn-neutral float-right" title="Plink" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Muhammad Muneeb.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>